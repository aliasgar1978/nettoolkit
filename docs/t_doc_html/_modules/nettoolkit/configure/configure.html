<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nettoolkit.configure.configure &mdash; nettoolkit 1.6.3 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=452006c5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            nettoolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/addressing/tech_doc.html">1. Addressing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/capture_it/tech_doc.html">2. capture-it</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/compare_it/tech_doc.html">3. compare-it</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/configure/tech_doc.html">4. configure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/facts_finder/tech_doc.html">5. facts-finder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/j2config/tech_doc.html">6. j2config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/nettoolkit/tech_doc.html">7. nettoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pyjuniper/tech_doc.html">8. pyjuniper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pynetcrypt/tech_doc.html">9. pynetcrypt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pyvig/tech_doc.html">10. pyvig</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nettoolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">nettoolkit.configure.configure</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for nettoolkit.configure.configure</h1><div class="highlight"><pre>
<span></span>
<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Imports</span>
<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">netmiko</span> <span class="kn">import</span> <span class="n">ConnectHandler</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">zip_longest</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">nettoolkit.nettoolkit_common</span> <span class="kn">import</span> <span class="n">printmsg</span><span class="p">,</span> <span class="n">STR</span><span class="p">,</span> <span class="n">LST</span><span class="p">,</span> <span class="n">Multi_Execution</span>
<span class="kn">from</span> <span class="nn">nettoolkit.nettoolkit_db</span> <span class="kn">import</span> <span class="n">read_xl_all_sheet</span>

<span class="kn">from</span> <span class="nn">nettoolkit.detect</span> <span class="kn">import</span> <span class="n">DeviceType</span>

<span class="c1"># -----------------------------------------------------------------------------</span>

<div class="viewcode-block" id="ConfigEnvironmentals">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.ConfigEnvironmentals">[docs]</a>
<span class="k">class</span> <span class="nc">ConfigEnvironmentals</span><span class="p">(</span><span class="n">Multi_Execution</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Configuration Object environmental properties. Inherits Multi_Execution</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span> <span class="n">log_folder</span><span class="p">,</span> <span class="n">config_log</span><span class="p">,</span> <span class="n">exec_log</span><span class="p">,</span> <span class="n">exec_display</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span> <span class="o">=</span> <span class="n">log_folder</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_log</span> <span class="o">=</span> <span class="n">config_log</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">exec_log</span> <span class="o">=</span> <span class="n">exec_log</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">exec_display</span> <span class="o">=</span> <span class="n">exec_display</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_env</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;log_folder&#39;</span><span class="p">:</span> <span class="n">log_folder</span><span class="p">,</span>
			<span class="s1">&#39;config_log&#39;</span><span class="p">:</span> <span class="n">config_log</span><span class="p">,</span>
			<span class="s1">&#39;exec_log&#39;</span><span class="p">:</span> <span class="n">exec_log</span><span class="p">,</span>
			<span class="s1">&#39;exec_display&#39;</span><span class="p">:</span> <span class="n">exec_display</span><span class="p">,</span>
		<span class="p">}</span></div>



<span class="c1"># -----------------------------------------------------------------------------</span>

<div class="viewcode-block" id="Config_common">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common">[docs]</a>
<span class="k">class</span> <span class="nc">Config_common</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Common Methods and properties for Configuration classes</span>
<span class="sd">	&quot;&quot;&quot;</span>    	

<div class="viewcode-block" id="Config_common.get_device_type">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.get_device_type">[docs]</a>
	<span class="k">def</span> <span class="nf">get_device_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">auth</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;detecting device type (cisco, juniper)</span>

<span class="sd">		Args:</span>
<span class="sd">			ip (str): device ip</span>
<span class="sd">			auth (dict): authentication dicationary with &#39;un&#39;, &#39;pw&#39;. &#39;en&#39; keys.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: device type if detected, else None</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">dev</span> <span class="o">=</span> <span class="n">DeviceType</span><span class="p">(</span><span class="n">dev_ip</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> 
				<span class="n">un</span><span class="o">=</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">],</span> 
				<span class="n">pw</span><span class="o">=</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">],</span>
			<span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2"> - Device Type Detection successful - </span><span class="si">{</span><span class="n">dev</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">dev</span><span class="o">.</span><span class="n">dtype</span>
		<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2"> - Device Type Detection Failed with Exception </span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Config_common.write_config_log">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.write_config_log">[docs]</a>
	<span class="k">def</span> <span class="nf">write_config_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;send out the configuration log to a log file </span>

<span class="sd">		Args:</span>
<span class="sd">			host (str): host/device name</span>
<span class="sd">			log (str/multiline): log to be write to</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_log</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;writing configuration application log @ </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">-config-apply.log&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">-config-apply.log&quot;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config_common.write_exec_log">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.write_exec_log">[docs]</a>
	<span class="k">def</span> <span class="nf">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;writes execution log (internal)</span>

<span class="sd">		Args:</span>
<span class="sd">			host (str): host/device name</span>
<span class="sd">			s (str/multiline): execution log content</span>
<span class="sd">			ends (str, optional): End string. Defaults to &#39;\n&#39;.</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec_display</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec_log</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">-exec.log&quot;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="n">ends</span><span class="p">)</span></div>



<div class="viewcode-block" id="Config_common.send_configuration">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.send_configuration">[docs]</a>
	<span class="k">def</span> <span class="nf">send_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conf_list</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;sends provided list of configuration to self device connection</span>

<span class="sd">		Args:</span>
<span class="sd">			conf_list (list): configuration change list</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: success/fail</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;applying config to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">op_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">send_config_set</span><span class="p">(</span><span class="n">conf_list</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;... Failed&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Config_common.get_connection">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.get_connection">[docs]</a>
	<span class="k">def</span> <span class="nf">get_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;retrive a new connection</span>

<span class="sd">		Returns:</span>
<span class="sd">			conn: connection object</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">conn</span> <span class="o">=</span> <span class="n">ConnectHandler</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">conn</span> <span class="o">=</span> <span class="n">ConnectHandler</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">connectionsuccess</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">return</span> <span class="n">conn</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Connection Failed to establish </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // No connection // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">connectionsuccess</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Config_common.terminate_connection">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.terminate_connection">[docs]</a>
	<span class="k">def</span> <span class="nf">terminate_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;terminate active connection</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span></div>


<div class="viewcode-block" id="Config_common.set_hostname">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Config_common.set_hostname">[docs]</a>
	<span class="k">def</span> <span class="nf">set_hostname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;retrive hostname from current connection</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">hostname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Hostname Retrival failed for device </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span></div>
</div>




<span class="c1"># ----------------------------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="Configure">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure">[docs]</a>
<span class="k">class</span> <span class="nc">Configure</span><span class="p">(</span><span class="n">Config_common</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Configure class to do configuration on a Cisco IOS or Juniper Junos device</span>
<span class="sd">	Inherits Config_common</span>

<span class="sd">	Args:</span>
<span class="sd">		ip (str): device ip address or FQDN</span>
<span class="sd">		auth (dict): authentication dicationary with &#39;un&#39;, &#39;pw&#39;. &#39;en&#39; keys.</span>
<span class="sd">		conf_list (list, optional): configuration change list. Defaults to None. Either</span>
<span class="sd">		conf_file (str, optional): configuration change file. Defaults to None. Or</span>
<span class="sd">		log_folder (str, optional): folder where logs to be stored. Defaults to None.</span>
<span class="sd">		config_log (bool, optional): generate configuration log. Defaults to True.</span>
<span class="sd">		exec_log (bool, optional): generate execution log. Defaults to True.</span>
<span class="sd">		exec_display (bool, optional): on screen display execution log. Defaults to True.</span>
<span class="sd">	&quot;&quot;&quot;</span>    	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span> 
		<span class="n">conf_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
		<span class="n">conf_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
		<span class="n">log_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">config_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span> <span class="o">=</span> <span class="n">conf_list</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">conf_file</span> <span class="o">=</span> <span class="n">conf_file</span>       <span class="c1"># prefered</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">log_folder</span> <span class="o">=</span> <span class="n">log_folder</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_log</span> <span class="o">=</span> <span class="n">config_log</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">exec_log</span> <span class="o">=</span> <span class="n">exec_log</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">exec_display</span> <span class="o">=</span> <span class="n">exec_display</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_get_conf_list_from_file</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_get_conf_list_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf_file</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
					<span class="n">conf_list</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
					<span class="n">conf_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">conf_list</span> <span class="p">]</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error Reading file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">return</span> <span class="kc">None</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span> <span class="ow">and</span> <span class="n">conf_list</span><span class="p">:</span>
				<span class="n">_d</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BEWARE: DUAL INPUT DETECTED, conf_list as well as conf_file. configuration file will override list. Continue [Y/N]&quot;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">_d</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">quit</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">conf_list</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span> <span class="o">=</span> <span class="n">conf_list</span>

<div class="viewcode-block" id="Configure.apply">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.apply">[docs]</a>
	<span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;apply the configuration to active connection</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No configurations to apply for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2"> // configuration=[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">,</span> <span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">device_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dev_var</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;device_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="p">,</span> 
			<span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span>
			<span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">],</span>
			<span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">],</span>
			<span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;en&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">],</span>
		<span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_start_push</span><span class="p">()</span></div>


	<span class="k">def</span> <span class="nf">_start_push</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_type</span> <span class="o">==</span> <span class="s1">&#39;juniper_junos&#39;</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">juniper_push</span><span class="p">()</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_type</span> <span class="o">==</span> <span class="s1">&#39;cisco_ios&#39;</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">cisco_push</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Undetected device </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="c1">## -------------- Juniper ------------------</span>

<div class="viewcode-block" id="Configure.juniper_push">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.juniper_push">[docs]</a>
	<span class="k">def</span> <span class="nf">juniper_push</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;method defining configuration push for Juniper devices </span>

<span class="sd">		Returns:</span>
<span class="sd">			bool/None: False if unable to connect, None after connection terminate</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;commit check&#39;</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;commit check&quot;</span><span class="p">)</span>
		<span class="c1">#</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connection</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectionsuccess</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_hostname</span><span class="p">()</span>
		<span class="c1">#</span>
		<span class="n">send_conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">send_conf</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Termination without configuration apply for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_config_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="p">)</span>
		<span class="c1">#</span>
		<span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">juniper_verify_push_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ERROR: Termination without configuration apply for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="c1">#</span>
		<span class="n">commit_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">juniper_commit</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">juniper_verify_commit_op</span><span class="p">(</span><span class="n">commit_return</span><span class="p">)</span>
		<span class="c1">#</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span></div>



<div class="viewcode-block" id="Configure.juniper_verify_push_op">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.juniper_verify_push_op">[docs]</a>
	<span class="k">def</span> <span class="nf">juniper_verify_push_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verifications on juniper configuration push output</span>

<span class="sd">		Args:</span>
<span class="sd">			op (multiline str): configuaration log output</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: success or syntex error</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">check</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;checking applied configuration for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="p">)</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">op</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;syntax error&#39;</span><span class="p">):</span> <span class="k">break</span>
			<span class="n">check</span> <span class="o">=</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;configuration check succeeds&quot;</span>
			<span class="k">if</span> <span class="n">check</span><span class="p">:</span> <span class="k">break</span>
		<span class="k">if</span> <span class="n">check</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...Failed</span><span class="se">\n</span><span class="s2">.  Re-Check configuration manually before commit</span><span class="se">\n</span><span class="s2">Got:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">check</span></div>


<div class="viewcode-block" id="Configure.juniper_verify_commit_op">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.juniper_verify_commit_op">[docs]</a>
	<span class="k">def</span> <span class="nf">juniper_verify_commit_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verification of commit</span>

<span class="sd">		Args:</span>
<span class="sd">			op (multiline str): configuaration log output</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;verifying configuration commit to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">check</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">op</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;configuration check succeeds&quot;</span><span class="p">)</span> 
				<span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;commit complete&quot;</span><span class="p">)</span>
				<span class="p">):</span>
				<span class="n">check</span><span class="o">+=</span><span class="mi">1</span> 
		<span class="c1">#</span>
		<span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...Failed</span><span class="se">\n</span><span class="s2">Got</span><span class="se">\n</span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Configure.juniper_commit">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.juniper_commit">[docs]</a>
	<span class="k">def</span> <span class="nf">juniper_commit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;commiting the pushed juniper configurations.</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: success or fail</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;commiting configurations to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">commit_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">commit_return</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...failed</span><span class="se">\n</span><span class="s2">Got</span><span class="se">\n</span><span class="si">{</span><span class="n">commit_return</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">False</span></div>


	<span class="c1">## -------------- Cisco ------------------</span>

<div class="viewcode-block" id="Configure.cisco_enable">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.cisco_enable">[docs]</a>
	<span class="k">def</span> <span class="nf">cisco_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;method to enable device mode</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="nb">any</span><span class="p">(</span> <span class="p">[</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">device_type</span> <span class="o">==</span> <span class="s1">&#39;cisco_ios&#39;</span>
			<span class="p">]</span> <span class="p">):</span>
			<span class="k">for</span> <span class="n">tries</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">net_connect</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;enable&quot;</span><span class="p">)</span>
					<span class="k">break</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hn</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hn</span><span class="si">}</span><span class="s2"> - enable failed on attemp </span><span class="si">{</span><span class="n">tries</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="k">continue</span></div>


<div class="viewcode-block" id="Configure.cisco_push">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.cisco_push">[docs]</a>
	<span class="k">def</span> <span class="nf">cisco_push</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;method defining configuration push for Cisco devices </span>

<span class="sd">		Returns:</span>
<span class="sd">			bool/None: False if unable to connect, None after connection terminate</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connection</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectionsuccess</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_hostname</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cisco_enable</span><span class="p">()</span>
		<span class="c1">#</span>
		<span class="n">send_conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conf_list</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">send_conf</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Termination without configuration apply for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="c1">#</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_config_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="p">)</span>
		<span class="c1">#</span>
		<span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cisco_verify_push_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">error</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ERROR: Termination without configuration apply for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="c1">#</span>
		<span class="n">_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cisco_commit</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">terminate_connection</span><span class="p">()</span></div>



<div class="viewcode-block" id="Configure.cisco_verify_push_op">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.cisco_verify_push_op">[docs]</a>
	<span class="k">def</span> <span class="nf">cisco_verify_push_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verifications on cisco configuration push output</span>

<span class="sd">		Args:</span>
<span class="sd">			op (multiline str): configuaration log output</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: success or syntex error</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">error</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;checking applied configuration for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="p">)</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">op</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
			<span class="n">error</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">error</span><span class="p">:</span> <span class="k">break</span>
		<span class="c1">#</span>
		<span class="k">if</span> <span class="n">error</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...Failed</span><span class="se">\n</span><span class="s2">.  Re-Check configuration manually and reapply</span><span class="se">\n</span><span class="s2">Got:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">op_return</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">error</span></div>



	<span class="c1"># save config</span>
<div class="viewcode-block" id="Configure.cisco_commit">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.Configure.cisco_commit">[docs]</a>
	<span class="k">def</span> <span class="nf">cisco_commit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;write mem on cisco device</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: success or fail</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;saving configurations for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_type</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2"> // </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">save_config</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...done&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">_return</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_exec_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;...failed</span><span class="se">\n</span><span class="s2">Got</span><span class="se">\n</span><span class="si">{</span><span class="n">_return</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">False</span></div>
</div>


<span class="c1"># ----------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="GroupsConfigure">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.GroupsConfigure">[docs]</a>
<span class="k">class</span> <span class="nc">GroupsConfigure</span><span class="p">(</span><span class="n">Multi_Execution</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Configure class to do configuration on a multiple group of devices at a time.</span>
<span class="sd">	Inherits Multi_Execution</span>

<span class="sd">	Args:</span>
<span class="sd">		auth (dict): authentication dicationary with &#39;un&#39;, &#39;pw&#39;. &#39;en&#39; keys.</span>
<span class="sd">		devices_config_dict (dict, optional): {device:[list of config], } . Defaults to {}.</span>
<span class="sd">		config_by_order (bool, optional): if True follows execution in provided order_list entries. Defaults to True.</span>
<span class="sd">		order_list (list, optional): order list in which execution to be done. Defaults to [].</span>
<span class="sd">		dev_apply_at_dict (dict, optional): time to apply config at (under implementation). Defaults to {}.</span>
<span class="sd">		log_folder (str, optional): folder where logs to be stored. Defaults to None.</span>
<span class="sd">		config_log (bool, optional): generate configuration log. Defaults to True.</span>
<span class="sd">		exec_log (bool, optional): generate execution log. Defaults to True.</span>
<span class="sd">		exec_display (bool, optional): on screen display execution log. Defaults to True.</span>
<span class="sd">		configure (bool, optional): configure or it is for test only. Defaults to False.</span>
<span class="sd">	&quot;&quot;&quot;</span>    	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span>
		<span class="n">devices_config_dict</span><span class="o">=</span><span class="p">{},</span>
		<span class="n">config_by_order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">order_list</span><span class="o">=</span><span class="p">[],</span>
		<span class="n">dev_apply_at_dict</span><span class="o">=</span><span class="p">{},</span>
		<span class="n">log_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">config_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">configure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span> <span class="o">=</span> <span class="n">devices_config_dict</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">order_list</span> <span class="o">=</span> <span class="n">order_list</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dev_apply_at_dict</span> <span class="o">=</span> <span class="n">dev_apply_at_dict</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_by_order</span> <span class="o">=</span> <span class="n">config_by_order</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_env</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s1">&#39;log_folder&#39;</span><span class="p">:</span> <span class="n">log_folder</span><span class="p">,</span>
			<span class="s1">&#39;config_log&#39;</span><span class="p">:</span> <span class="n">config_log</span><span class="p">,</span>
			<span class="s1">&#39;exec_log&#39;</span><span class="p">:</span> <span class="n">exec_log</span><span class="p">,</span>
			<span class="s1">&#39;exec_display&#39;</span><span class="p">:</span> <span class="n">exec_display</span><span class="p">,</span>
		<span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">configure</span> <span class="o">=</span> <span class="n">configure</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">40</span><span class="si">}</span><span class="se">\n</span><span class="s1">INFO: </span><span class="se">\t</span><span class="s1">A Group Configuration, Called...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">A Group Configuration, Ended...</span><span class="se">\n</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">43</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_verify_inputs</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_by_order</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_by_orderlist</span><span class="p">()</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">Verifying inputs...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">Verifying inputs, done...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">_verify_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_get_dev_conf_dict_ip_list</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_get_order_list</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">remove_empty_config_lines</span><span class="p">()</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">configuring in order by order_list...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">configuration by order_list, done...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">configure_by_orderlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;configure devices as per sequence provided in order_list</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">order</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

<div class="viewcode-block" id="GroupsConfigure.execute">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.GroupsConfigure.execute">[docs]</a>
	<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;executor</span>

<span class="sd">		Args:</span>
<span class="sd">			ip (str): device ip or FQDN</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">conf_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]</span>
		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">Starting Configuration on: </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">:</span>
			<span class="n">CFG</span> <span class="o">=</span> <span class="n">Configure</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> 
				<span class="n">conf_list</span><span class="o">=</span><span class="n">conf_list</span><span class="p">,</span>
				<span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config_env</span>
			<span class="p">)</span>
			<span class="n">CFG</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">Configuration skipped as `configure` parameter is set to `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">,</span>
				 <span class="s2">&quot;, change it True in order to start configure process.&quot;</span><span class="p">)</span></div>

			<span class="c1"># print(&quot;delta changes:\n&quot;, &quot;\n&quot;.join(conf_list))</span>
			<span class="c1"># print(&#39;\t\t\t&#39; + &quot;-&quot;*80)</span>


	<span class="k">def</span> <span class="nf">_get_dev_conf_dict_ip_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: Incorrect input: configuration parameters in devices_config_dict&quot;</span><span class="p">,</span>
					<span class="sa">f</span><span class="s2">&quot;Expected `dict` got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="s1">&#39;cmds_list&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="s1">&#39;cmd_file&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: Dual configuration input detected for ip </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span>
					<span class="s1">&#39;file input will be prefered and considered&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="s1">&#39;cmd_file&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmd_file&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
					<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Incorrect input: command file name for ip </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmd_file&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmd_file&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
						<span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
						<span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">_</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]</span> <span class="p">]</span>
						<span class="k">del</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmd_file&#39;</span><span class="p">])</span>
					<span class="k">continue</span>
				<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Error Occured for ip </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="n">quit</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;cmds_list&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]:</span>
					<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="k">continue</span>
					<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Invalid input: command detected for ip </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">, Expected `str`. got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
					<span class="n">quit</span><span class="p">()</span>
				<span class="k">continue</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: No configuration input detected for ip </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">. This device will be skipped&quot;</span><span class="p">)</span>
			<span class="n">value</span><span class="p">[</span><span class="s1">&#39;skip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

	<span class="k">def</span> <span class="nf">_get_order_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">order_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">ip</span> <span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">)},]</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INFO: </span><span class="se">\t\t</span><span class="s2">No order_list provided, cretated one </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Incorrect input: order_list. expected (tuple/list), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_cd_to_ol</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_ol_to_cd</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_cd_to_ol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">flatten_ol</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">LST</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">))</span>
		<span class="n">missing_ones</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">ip</span> <span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">)</span>  <span class="ow">and</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flatten_ol</span><span class="p">])</span>
		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: Device(s) missing in order list [</span><span class="si">{</span><span class="n">missing_ones</span><span class="si">}</span><span class="s2">] were appened.&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">missing_ones</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">flatten_ol</span> <span class="o">=</span> <span class="n">flatten_ol</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">missing_ones</span><span class="p">))</span>
		<span class="k">if</span> <span class="n">missing_ones</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">INFO: updated order_list=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_ol_to_cd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">removed</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">ol_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_ol</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">ol_item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">remove_order_list_item</span><span class="p">(</span><span class="n">ol_item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">)</span>
				<span class="n">removed</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">removed</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">order_list</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">remove_empty_members</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="p">)</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INFO: updated order_list=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">order_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GroupsConfigure.remove_empty_config_lines">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.GroupsConfigure.remove_empty_config_lines">[docs]</a>
	<span class="k">def</span> <span class="nf">remove_empty_config_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;sanitizer: removes empty lines from configuration</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">devices_config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">remove_empty_members</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="GroupsConfigure.remove_order_list_item">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.GroupsConfigure.remove_order_list_item">[docs]</a>
	<span class="k">def</span> <span class="nf">remove_order_list_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;sanitizer: Remove device from configuration sequence where no configuration changes provided.</span>

<span class="sd">		Args:</span>
<span class="sd">			item (str): device ip or FQDN</span>
<span class="sd">			lst (list): configuration change list</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
					<span class="n">lst</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
					<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: Addititional device `</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">`found in ordered list, which is missing in devices_config_dict.&quot;</span><span class="p">,</span>
						<span class="s2">&quot;Removed from order_list &quot;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">remove_order_list_item</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span></div>
</div>




<span class="c1"># ----------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="ConfigureByExcel">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.ConfigureByExcel">[docs]</a>
<span class="k">class</span> <span class="nc">ConfigureByExcel</span><span class="p">(</span><span class="n">ConfigEnvironmentals</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;class to do configuration based on configuration changes provided in excel.</span>
<span class="sd">	All listed devices in a single Excel tab will be executed at once (simultaneously).</span>
<span class="sd">	Multiple Excel tabs/files can be provided to execute those in sequence. </span>

<span class="sd">	Inherits ConfigEnvironmentals</span>

<span class="sd">	Args:</span>
<span class="sd">		auth (dict): authentication dicationary with &#39;un&#39;, &#39;pw&#39;. &#39;en&#39; keys.</span>
<span class="sd">		files (list, optional): list of excel files, will be executed in provided sequence. Defaults to [].</span>
<span class="sd">		tab_sort_order (list, optional): Excel tabs execution order. Defaults to []. ( options: privide in list manually, `ascending`, `reversed`)</span>
<span class="sd">		log_folder (str, optional): folder where logs to be stored. Defaults to None.</span>
<span class="sd">		config_log (bool, optional): generate configuration log. Defaults to True.</span>
<span class="sd">		exec_log (bool, optional): generate execution log. Defaults to True.</span>
<span class="sd">		exec_display (bool, optional): on screen display execution log. Defaults to True.</span>
<span class="sd">		configure (bool, optional): configure or it is for test only. Defaults to False.</span>
<span class="sd">		sleep_time_between_group (int, optional): sleep time between execution of two groups of executions. Defaults to 0.</span>
<span class="sd">	&quot;&quot;&quot;</span>    	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span>
		<span class="n">files</span><span class="o">=</span><span class="p">[],</span>
		<span class="n">tab_sort_order</span><span class="o">=</span><span class="p">[],</span>
		<span class="n">log_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">config_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">exec_display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
		<span class="n">configure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">sleep_time_between_group</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
		<span class="p">):</span>
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">log_folder</span><span class="p">,</span> <span class="n">config_log</span><span class="p">,</span> <span class="n">exec_log</span><span class="p">,</span> <span class="n">exec_display</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span> <span class="o">=</span> <span class="n">tab_sort_order</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">configure</span> <span class="o">=</span> <span class="n">configure</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sleep_time_between_group</span> <span class="o">=</span> <span class="n">sleep_time_between_group</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid argument `files`: should be of `list` type, got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>
			<span class="n">quit</span><span class="p">()</span>


	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: CONFIGURATION PROCESS...BEGINNING&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: CONFIGURATION PROCESS...ENDS&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_load_dfs</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_define_sort_order</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cmds_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cmds_ordered_group</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">Reading Excel file and Loading tabs...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">Reading Excel file and Loading tabs... DONE...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">_load_dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ordered_configs_df_dict_list</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ordered_configs_df_dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_xl_all_sheet</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">Defining sort order...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">Defining sort order... DONE...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">_define_sort_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ascending&#39;</span><span class="p">,</span> <span class="s1">&#39;ordered&#39;</span><span class="p">,</span> <span class="s1">&#39;alphabetical&#39;</span><span class="p">,</span> <span class="p">[]):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_set_sort_order</span><span class="p">(</span><span class="s1">&#39;ascending&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;reversed&#39;</span><span class="p">,</span> <span class="s1">&#39;descending&#39;</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_set_sort_order</span><span class="p">(</span><span class="s1">&#39;descending&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_verify_sort_orders</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_set_sort_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span> <span class="o">=</span> <span class="p">[</span>
			<span class="nb">sorted</span><span class="p">(</span><span class="n">dfd</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;ascending&#39;</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dfd</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
			<span class="k">for</span> <span class="n">dfd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_configs_df_dict_list</span> 
		<span class="p">]</span>

	<span class="k">def</span> <span class="nf">_verify_sort_orders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">tso</span><span class="p">,</span> <span class="n">dfd</span> <span class="ow">in</span> <span class="n">zip_longest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_configs_df_dict_list</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">tso</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">dfd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CRITICAL: Length of Order sequences v/s excel files count mismatch, both should be with same length&quot;</span><span class="p">)</span>
				<span class="n">quit</span><span class="p">()</span>
			<span class="c1">#</span>
			<span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">tso</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">dfd</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="k">continue</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRITICAL: Mismatch Sheet Names with provided order, please check&quot;</span><span class="p">)</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Sort Order = </span><span class="si">{</span><span class="n">tso</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Sheets available = </span><span class="si">{</span><span class="n">dfd</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">quit</span><span class="p">()</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">Defining commands groups...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">Defining commands groups... DONE...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_cmds_ordered_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">cmds_groups</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">tso</span><span class="p">,</span> <span class="n">dfd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_configs_df_dict_list</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">tso</span><span class="p">:</span>
				<span class="n">cmds_group</span> <span class="o">=</span> <span class="p">{}</span>
				<span class="n">df</span> <span class="o">=</span> <span class="n">dfd</span><span class="p">[</span><span class="n">tab</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
					<span class="n">cmds_group</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmds_list&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">ip</span><span class="p">])}</span> 
				<span class="n">cmds_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmds_group</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">cmds_groups</span>

	<span class="nd">@printmsg</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t</span><span class="s1">Configuration of devices, Started...&#39;</span><span class="p">,</span>
			 <span class="n">post</span><span class="o">=</span><span class="s1">&#39;INFO: </span><span class="se">\t\t</span><span class="s1">Configuration of devices, Ended...&#39;</span> <span class="p">)</span>
	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;starts configuration of devices</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">tso_list</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_sort_order</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmds_groups</span><span class="p">):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_concurrance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cg</span><span class="p">,</span> <span class="n">tso_list</span><span class="p">):</span> <span class="k">continue</span>
			<span class="n">GC</span> <span class="o">=</span> <span class="n">GroupsConfigure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span>
				<span class="n">devices_config_dict</span> <span class="o">=</span> <span class="n">cg</span><span class="p">,</span> 
				<span class="n">configure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">,</span>
				<span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config_env</span>
			<span class="p">)</span>
			<span class="n">GC</span><span class="p">()</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_time_between_group</span><span class="p">:</span>
				<span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleep_time_between_group</span><span class="p">)</span>

<div class="viewcode-block" id="ConfigureByExcel.get_concurrance">
<a class="viewcode-back" href="../../../docs/t_doc/configure/configure.html#nettoolkit.configure.configure.ConfigureByExcel.get_concurrance">[docs]</a>
	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">get_concurrance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cg</span><span class="p">,</span> <span class="n">tso_list</span><span class="p">):</span>
		<span class="n">user_concern</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration on group of devices GROUP</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: [</span><span class="si">{</span><span class="n">tso_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">] : (</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">cg</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">) ready to process. Want to continue [y/n]&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">user_concern</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>  <span class="k">return</span> <span class="kc">True</span>
		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Configuration on group of devices GROUP</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: [</span><span class="si">{</span><span class="n">tso_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">] : Not confirmed, Aborted !!!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">False</span></div>
</div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ALIASGAR [ALI].</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>