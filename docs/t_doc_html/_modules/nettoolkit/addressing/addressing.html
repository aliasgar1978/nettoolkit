<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nettoolkit.addressing.addressing &mdash; nettoolkit 1.6.3 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=452006c5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            nettoolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/addressing/tech_doc.html">1. Addressing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/capture_it/tech_doc.html">2. capture-it</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/compare_it/tech_doc.html">3. compare-it</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/configure/tech_doc.html">4. configure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/facts_finder/tech_doc.html">5. facts-finder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/j2config/tech_doc.html">6. j2config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/nettoolkit/tech_doc.html">7. nettoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pyjuniper/tech_doc.html">8. pyjuniper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pynetcrypt/tech_doc.html">9. pynetcrypt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/t_doc/pyvig/tech_doc.html">10. pyvig</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nettoolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">nettoolkit.addressing.addressing</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for nettoolkit.addressing.addressing</h1><div class="highlight"><pre>
<span></span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">total_ordering</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">nettoolkit.nettoolkit_common.gpl</span> <span class="kn">import</span> <span class="n">STR</span><span class="p">,</span> <span class="n">LST</span><span class="p">,</span> <span class="n">IO</span>

<span class="c1"># from errors import incorrectinput</span>
<span class="n">incorrectinput</span> <span class="o">=</span> <span class="s1">&#39;INCORRECT SUBNET OR SUBNET MASK DETECTED NULL RETURNED&#39;</span>
<span class="n">SQRS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>

<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># Module Functions</span>
<span class="c1"># ----------------------------------------------------------------------------</span>

<div class="viewcode-block" id="expand">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.expand">[docs]</a>
<span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="n">v6subnet</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Expand the V6 subnet to its full length.</span>

<span class="sd">	Args:</span>
<span class="sd">		v6subnet (str): zipped v6 subnet</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: expanded v6 subnet</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="c1"># try:</span>
	<span class="n">p</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
	<span class="n">sip</span> <span class="o">=</span> <span class="n">v6subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">withMask</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v6subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">v6subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sip</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
		<span class="c1"># ~~~~~~ No padding, inserting zeros in middle ~~~~~~~</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
			<span class="n">p</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">string_concate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">get_hext</span><span class="p">(</span><span class="n">v6subnet</span><span class="p">,</span> <span class="n">hexTnum</span><span class="o">=</span><span class="n">x</span><span class="p">),</span> <span class="n">conj</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
		<span class="n">v6subnet</span> <span class="o">=</span> <span class="n">p</span>
	<span class="k">else</span> <span class="p">:</span>
		<span class="c1"># ~~~~~~~ pad leading zeros ~~~~~~~</span>
		<span class="n">lsip</span> <span class="o">=</span> <span class="n">sip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">lsip</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
			<span class="n">p</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">string_concate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">conj</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">v6subnet</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">v6subnet</span>
	<span class="k">if</span> <span class="n">withMask</span><span class="p">:</span>
		<span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v6subnet</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="s1">&#39;</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">v6subnet</span></div>

	<span class="c1"># except:</span>
	<span class="c1"># 	return False</span>

<div class="viewcode-block" id="get_hext">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.get_hext">[docs]</a>
<span class="k">def</span> <span class="nf">get_hext</span><span class="p">(</span><span class="n">v6subnet</span><span class="p">,</span> <span class="n">hexTnum</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>	
<span class="w">	</span><span class="sd">&quot;&quot;&quot;get the a hextate of v6 subnet.</span>

<span class="sd">	Args:</span>
<span class="sd">		v6subnet (str): v6 subnet string</span>
<span class="sd">		hexTnum (int): hextate number</span>

<span class="sd">	Raises:</span>
<span class="sd">		Exception: Raise Exception if incorrect input</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: hextate string</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">test</span> <span class="o">=</span> <span class="n">hexTnum</span> <span class="o">==</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">v6subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">hexTnum</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">hexTnum</span><span class="o">&lt;=</span><span class="mi">8</span><span class="p">]):</span>
			<span class="n">sip</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
			<span class="n">lsip</span> <span class="o">=</span> <span class="n">sip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">hexTnum</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsip</span><span class="p">):</span>
				<span class="n">lsiphext</span> <span class="o">=</span> <span class="n">lsip</span><span class="p">[</span><span class="n">hexTnum</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">lsiphext</span><span class="p">:</span> <span class="k">return</span> <span class="n">lsip</span><span class="p">[</span><span class="n">hexTnum</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">return</span> <span class="s1">&#39;0&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">rsip</span> <span class="o">=</span> <span class="n">sip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">rsip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="n">rsip</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">if</span> <span class="mi">8</span><span class="o">-</span><span class="n">hexTnum</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">rsip</span><span class="p">):</span>
					<span class="k">return</span> <span class="n">rsip</span><span class="p">[(</span><span class="mi">9</span><span class="o">-</span><span class="n">hexTnum</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">return</span> <span class="s1">&#39;0&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">incorrectinput</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">None</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">incorrectinput</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="bin_mask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.bin_mask">[docs]</a>
<span class="k">def</span> <span class="nf">bin_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;mask representation in binary (ex: 255.255.255.0)</span>

<span class="sd">	Args:</span>
<span class="sd">		mask (int): mask in number </span>

<span class="sd">	Returns:</span>
<span class="sd">		str: mask in 8 byte format</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
	<span class="n">decmask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">*</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">mask</span><span class="p">)</span><span class="o">*</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="n">o1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">decmask</span><span class="p">[</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">8</span><span class="p">]</span> <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">decmask</span><span class="p">[</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">16</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">decmask</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span> <span class="mi">24</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o4</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">decmask</span><span class="p">[</span><span class="mi">24</span><span class="p">:</span> <span class="mi">32</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="k">return</span> <span class="n">o1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">o2</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">o3</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">o4</span>	</div>



<div class="viewcode-block" id="invmask_to_mask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.invmask_to_mask">[docs]</a>
<span class="k">def</span> <span class="nf">invmask_to_mask</span><span class="p">(</span><span class="n">invmask</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;convert inverse mask to decimal mask</span>

<span class="sd">	Args:</span>
<span class="sd">		invmask (str): mask representation in inverse format (ex: 0.0.0.31)</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: mask (ex: 27)</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">m</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="n">invmask</span><span class="p">)</span>
	<span class="k">return</span> <span class="mi">32</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_invalid_subnet</span><span class="p">(</span><span class="n">subnet</span><span class="p">):</span> 
<span class="w">	</span><span class="sd">&quot;&quot;&quot;invalid subnet str</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Not a VALID Subnet </span><span class="si">{</span><span class="n">subnet</span><span class="si">}</span><span class="s2">&quot;</span>


<div class="viewcode-block" id="to_dec_mask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.to_dec_mask">[docs]</a>
<span class="k">def</span> <span class="nf">to_dec_mask</span><span class="p">(</span><span class="n">dotted_mask</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Decimal mask representation</span>

<span class="sd">	Args:</span>
<span class="sd">		dotted_mask (str): input mask = dotted mask</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: mask</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">return</span> <span class="n">bin2decmask</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">dotted_mask</span><span class="p">))</span></div>



<div class="viewcode-block" id="bin2dec">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.bin2dec">[docs]</a>
<span class="k">def</span> <span class="nf">bin2dec</span><span class="p">(</span><span class="n">binnet</span><span class="p">):</span> 
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Decimal network representation / integer value</span>

<span class="sd">	Args:</span>
<span class="sd">		binnet (str): input = dotted network</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: decimal number of network</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">binnet</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
	<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">binnet</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="bin2decmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.bin2decmask">[docs]</a>
<span class="k">def</span> <span class="nf">bin2decmask</span><span class="p">(</span><span class="n">binmask</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Decimal mask representation / integer value</span>

<span class="sd">	Args:</span>
<span class="sd">		binmask (str): input mask = binary mask in number</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: mask</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">return</span> <span class="n">binmask</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="binsubnet">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.binsubnet">[docs]</a>
<span class="k">def</span> <span class="nf">binsubnet</span><span class="p">(</span><span class="n">subnet</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;convert subnet to binary:0s and 1s</span>

<span class="sd">	Args:</span>
<span class="sd">		subnet (str): subnet string (v4, v6)</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: binary subnet representation ( 0s and 1s )</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">found</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">):</span> <span class="n">version</span><span class="p">,</span> <span class="n">split_by</span><span class="p">,</span> <span class="n">bit_per_oct</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">8</span>
		<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">found</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">):</span> <span class="n">version</span><span class="p">,</span> <span class="n">split_by</span><span class="p">,</span> <span class="n">bit_per_oct</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">16</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="n">octs</span> <span class="o">=</span> <span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">split_by</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">octs</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
				<span class="n">bo</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">o</span><span class="p">)))[</span><span class="mi">2</span><span class="p">:]</span>
			<span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
				<span class="n">bo</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">bit_per_oct</span><span class="p">)))[</span><span class="mi">2</span><span class="p">:]</span>
			<span class="n">lbo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bo</span><span class="p">)</span>
			<span class="n">pzero</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">bit_per_oct</span> <span class="o">-</span> <span class="n">lbo</span><span class="p">)</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">pzero</span> <span class="o">+</span> <span class="n">bo</span>
		<span class="k">return</span> <span class="n">s</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">pass</span></div>


<span class="c1"># integer to octet</span>
<div class="viewcode-block" id="dec2dotted_ip">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.dec2dotted_ip">[docs]</a>
<span class="k">def</span> <span class="nf">dec2dotted_ip</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;convert decimal ip address to dotted decimal ip notation.</span>

<span class="sd">	Args:</span>
<span class="sd">		n (int): integer/decimal number</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: ip address (dotted decimal format)</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">bin_bytes</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
	<span class="n">o4</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bin_bytes</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bin_bytes</span><span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bin_bytes</span><span class="p">[</span><span class="o">-</span><span class="mi">24</span><span class="p">:</span><span class="o">-</span><span class="mi">16</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="n">o1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bin_bytes</span><span class="p">[:</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
	<span class="k">return</span> <span class="n">o1</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">o2</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">o3</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">o4</span></div>


<span class="c1"># 255 -&gt; 24</span>
<div class="viewcode-block" id="inv_subnet_size_to_mask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.inv_subnet_size_to_mask">[docs]</a>
<span class="k">def</span> <span class="nf">inv_subnet_size_to_mask</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;converts inverse subnet size to get subnet mask value</span>

<span class="sd">	Args:</span>
<span class="sd">		n (int): number of ips in a subnet excluding networkip (ex: 127)</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: subnet mask (25)</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">return</span> <span class="mi">32</span><span class="o">-</span><span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="mask2subnetsize">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.mask2subnetsize">[docs]</a>
<span class="k">def</span> <span class="nf">mask2subnetsize</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;get subnet size from mask</span>

<span class="sd">	Args:</span>
<span class="sd">		m (n): subnet mask</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: number of ip available in given subnet</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="n">m</span></div>


<span class="c1"># 256 -&gt; 24</span>
<div class="viewcode-block" id="subnet_size_to_mask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.subnet_size_to_mask">[docs]</a>
<span class="k">def</span> <span class="nf">subnet_size_to_mask</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;converts subnet size to get subnet mask value</span>

<span class="sd">	Args:</span>
<span class="sd">		n (int): number of ips in a subnet (ex: 128)</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: subnet mask (25)</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">subs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">SQRS</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span> <span class="k">continue</span>
		<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span> 
			<span class="n">subs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">break</span>
		<span class="n">subs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
		<span class="n">subs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
		<span class="k">break</span>
	<span class="n">masks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">subs</span><span class="p">:</span>
		<span class="n">n</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
		<span class="n">masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="mi">32</span><span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>  <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">masks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">masks</span></div>


<span class="c1"># decimal network ip and length -&gt; subnet/mask</span>
<div class="viewcode-block" id="get_subnet">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.get_subnet">[docs]</a>
<span class="k">def</span> <span class="nf">get_subnet</span><span class="p">(</span><span class="n">decimal_network_ip</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;get subnet/mask from decimal network ip and size of subnet</span>

<span class="sd">	Args:</span>
<span class="sd">		decimal_network_ip (int): integer/decimal number</span>
<span class="sd">		length (int): number of ips in a subnet (ex: 128)</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: string repr of subnet (subnet/mask)</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">breakup</span> <span class="o">=</span> <span class="n">decimal_network_ip</span><span class="o">/</span><span class="n">length</span> 
	<span class="n">s</span> <span class="o">=</span> <span class="n">dec2dotted_ip</span><span class="p">(</span><span class="n">decimal_network_ip</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">subnet_size_to_mask</span><span class="p">(</span><span class="n">length</span><span class="p">))</span>
	<span class="k">if</span> <span class="n">breakup</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
		<span class="k">return</span> <span class="n">s</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid subnet/mask cannot return </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_subnets">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.get_subnets">[docs]</a>
<span class="k">def</span> <span class="nf">get_subnets</span><span class="p">(</span><span class="n">decimal_network_ip</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;get subnets and sizes from decimal network ip and subnet length (under development)</span>

<span class="sd">	Args:</span>
<span class="sd">		decimal_network_ip (int): integer/decimal number</span>
<span class="sd">		length (int): number of ips in a subnet (ex: 128)</span>

<span class="sd">	Returns:</span>
<span class="sd">		dict: dictionary of counts and size</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="n">breakup</span> <span class="o">=</span> <span class="n">decimal_network_ip</span><span class="o">/</span><span class="n">length</span> 
	<span class="n">s</span> <span class="o">=</span> <span class="n">dec2dotted_ip</span><span class="p">(</span><span class="n">decimal_network_ip</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">subnet_size_to_mask</span><span class="p">(</span><span class="n">length</span><span class="p">))</span>
	<span class="k">if</span> <span class="n">breakup</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
		<span class="k">return</span> <span class="n">s</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
			<span class="n">point</span> <span class="o">=</span> <span class="n">breakup</span><span class="o">%</span><span class="nb">int</span><span class="p">(</span><span class="n">breakup</span><span class="p">)</span>
			<span class="n">counts</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">point</span>
			<span class="k">if</span> <span class="n">counts</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
				<span class="n">new_sizes</span> <span class="o">=</span> <span class="n">length</span><span class="o">/</span><span class="n">counts</span>
				<span class="k">return</span> <span class="p">{</span><span class="s1">&#39;counts&#39;</span><span class="p">:</span> <span class="n">counts</span><span class="o">+</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">new_sizes</span><span class="p">}</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="n">breakup</span> <span class="o">=</span> <span class="n">counts</span></div>


<div class="viewcode-block" id="is_overlap">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.is_overlap">[docs]</a>
<span class="k">def</span> <span class="nf">is_overlap</span><span class="p">(</span><span class="n">range1</span><span class="p">,</span> <span class="n">range2</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;check if range1 and range2 are overlaping</span>

<span class="sd">	Args:</span>
<span class="sd">		range1 (range): range1 of items</span>
<span class="sd">		range2 (range): range2 of items</span>

<span class="sd">	Returns:</span>
<span class="sd">		bool: whether range1 and range2 are overlaping or not.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">if</span> <span class="n">range1</span><span class="o">.</span><span class="n">start</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">range2</span> <span class="ow">and</span> <span class="n">range1</span><span class="o">.</span><span class="n">stop</span><span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">range2</span><span class="p">:</span>
		<span class="k">return</span> <span class="kc">False</span>
	<span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="range_subset">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.range_subset">[docs]</a>
<span class="k">def</span> <span class="nf">range_subset</span><span class="p">(</span><span class="n">range1</span><span class="p">,</span> <span class="n">range2</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;check whether range1 is a subset of range2</span>

<span class="sd">	Args:</span>
<span class="sd">		range1 (range): range1 of items</span>
<span class="sd">		range2 (range): range2 of items</span>

<span class="sd">	Returns:</span>
<span class="sd">		bool: whether range1 is part of range2 or not.</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">range1</span><span class="p">:</span>
		<span class="k">return</span> <span class="kc">True</span>  <span class="c1"># empty range cannot subset of anything</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">range2</span><span class="p">:</span>
		<span class="k">return</span> <span class="kc">False</span>  <span class="c1"># non-empty range can not subset of empty range</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">range1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">range1</span><span class="o">.</span><span class="n">step</span> <span class="o">%</span> <span class="n">range2</span><span class="o">.</span><span class="n">step</span><span class="p">:</span>
		<span class="k">return</span> <span class="kc">False</span>  <span class="c1"># steps check</span>
	<span class="k">return</span> <span class="n">range1</span><span class="o">.</span><span class="n">start</span> <span class="ow">in</span> <span class="n">range2</span> <span class="ow">and</span> <span class="n">range1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">range2</span></div>



<div class="viewcode-block" id="addressing">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.addressing">[docs]</a>
<span class="k">def</span> <span class="nf">addressing</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="n">ddc_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;proives ip-subnet object for various functions on it</span>

<span class="sd">	Args:</span>
<span class="sd">		subnet (str): ipv4 or ipv6 subnet with/without mask</span>
<span class="sd">		ddc_mask (str, None): provide dottel decimal mask (v4 only) or None.</span>

<span class="sd">	Returns:</span>
<span class="sd">		IPv4, IPv6: IPv4 or IPv6 object</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">if</span> <span class="n">ddc_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">mask</span> <span class="o">=</span> <span class="n">to_dec_mask</span><span class="p">(</span><span class="n">ddc_mask</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">subnet</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple mask entries received.</span><span class="se">\n</span><span class="s2">subnet mask value will </span><span class="si">{</span><span class="n">subnet</span><span class="si">}</span><span class="s2"> override, ddc_mask value </span><span class="si">{</span><span class="n">ddc_mask</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid dotted decimal mask provided... required format [255.255.255.0] got [</span><span class="si">{ddc_mask}</span><span class="s2">]&quot;</span><span class="p">)</span>
	<span class="n">v_obj</span> <span class="o">=</span> <span class="n">Validation</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>	
	<span class="k">if</span> <span class="n">v_obj</span><span class="o">.</span><span class="n">validated</span><span class="p">:</span> <span class="k">return</span> <span class="n">v_obj</span><span class="o">.</span><span class="n">ip_obj</span></div>



<div class="viewcode-block" id="get_summaries">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.get_summaries">[docs]</a>
<span class="k">def</span> <span class="nf">get_summaries</span><span class="p">(</span><span class="o">*</span><span class="n">net_list</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;summarize the provided network prefixes, provide all networks as arguments.</span>

<span class="sd">	Args:</span>
<span class="sd">		net_list (args): variable arguments ( networks )</span>

<span class="sd">	Returns:</span>
<span class="sd">		list: summaries</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">net_list</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">set</span><span class="p">)):</span> <span class="k">return</span> <span class="kc">None</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">Summary</span><span class="p">(</span><span class="o">*</span><span class="n">net_list</span><span class="p">)</span>
	<span class="n">s</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
	<span class="n">summaries</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">prefixes</span>
	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>	
	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
		<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">MAX_RECURSION_DEPTH</span><span class="p">:</span> <span class="k">break</span>
		<span class="n">ss</span> <span class="o">=</span> <span class="n">Summary</span><span class="p">(</span><span class="o">*</span><span class="n">summaries</span><span class="p">)</span>
		<span class="n">ss</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">summaries</span> <span class="o">==</span> <span class="n">ss</span><span class="o">.</span><span class="n">prefixes</span><span class="p">:</span> <span class="k">break</span>
		<span class="n">summaries</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">prefixes</span>
	<span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">summaries</span><span class="p">)</span></div>

	<span class="c1"># return sorted_v4_addresses(summaries)</span>


<div class="viewcode-block" id="calc_summmaries">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.calc_summmaries">[docs]</a>
<span class="k">def</span> <span class="nf">calc_summmaries</span><span class="p">(</span><span class="n">min_subnet_size</span><span class="p">,</span> <span class="o">*</span><span class="n">net_list</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;summarize the provided network prefixes, provide all networks as arguments.</span>
<span class="sd">	minimum subnet summarized to provided min_subnet_size parameter</span>

<span class="sd">	Args:</span>
<span class="sd">		min_subnet_size (int): minimuze subnet mask to be summarized up on</span>
<span class="sd">		net_list (args): variable arguments ( networks )</span>

<span class="sd">	Returns:</span>
<span class="sd">		list: summaries</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="n">summaries</span> <span class="o">=</span> <span class="n">get_summaries</span><span class="p">(</span><span class="o">*</span><span class="n">net_list</span><span class="p">)</span>
	<span class="n">nset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">subnet</span> <span class="ow">in</span> <span class="n">summaries</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">)</span> <span class="ow">and</span> <span class="n">subnet</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="n">min_subnet_size</span><span class="p">:</span>
			<span class="n">nset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">subnet</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">min_subnet_size</span><span class="p">))</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">min_subnet_size</span><span class="p">:</span>
			<span class="n">nset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">IPv4</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">min_subnet_size</span><span class="p">))</span>
	<span class="n">summaries</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nset</span><span class="p">)</span>
	<span class="n">nSummaries</span> <span class="o">=</span> <span class="n">get_summaries</span><span class="p">(</span><span class="o">*</span><span class="nb">set</span><span class="p">(</span><span class="n">summaries</span><span class="p">))</span>
	<span class="k">return</span> <span class="n">nSummaries</span></div>


<div class="viewcode-block" id="break_prefix">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.break_prefix">[docs]</a>
<span class="k">def</span> <span class="nf">break_prefix</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="n">mask_size</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;downsize larger prefix size to smaller size</span>

<span class="sd">	Args:</span>
<span class="sd">		pfx (str): prefix/subnet</span>
<span class="sd">		mask_size (int): required mask size numeric</span>

<span class="sd">	Raises:</span>
<span class="sd">		Exception: InputError: Invalid Prefix</span>
<span class="sd">		Exception: InputError: Invalid mask_size</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: broken prefix</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InputError: Invalid Prefix </span><span class="si">{</span><span class="n">pfx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">bit_length</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">mask_size</span><span class="p">)</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InputError: Invalid mask_size </span><span class="si">{</span><span class="n">mask_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="n">d</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="n">bit_length</span>
	<span class="k">return</span> <span class="n">s</span><span class="o">/</span><span class="n">d</span></div>


<div class="viewcode-block" id="recapsulate">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.recapsulate">[docs]</a>
<span class="k">def</span> <span class="nf">recapsulate</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;capsulate provided subnet (str, IPv4) with given sizing.</span>

<span class="sd">	Args:</span>
<span class="sd">		subnet (str, IPv4): string or IPv4 Object</span>
<span class="sd">		size (int): subnet mask, for sizing</span>

<span class="sd">	Returns:</span>
<span class="sd">		str: sized/capsulated subnet</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subnet</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">):</span> <span class="n">subnet</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
	<span class="n">s</span> <span class="o">=</span> <span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
	<span class="n">v4s</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">(</span><span class="n">withMask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">v4s</span></div>


<div class="viewcode-block" id="isSplittedRoute">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.isSplittedRoute">[docs]</a>
<span class="k">def</span> <span class="nf">isSplittedRoute</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;checks if ip route is splitted in multiple lines or not.</span>

<span class="sd">	Args:</span>
<span class="sd">		line (str): ip route line from configuration</span>

<span class="sd">	Returns:</span>
<span class="sd">		int: 1: No single line,  0 : Yes splitted line [line1],  -1: Yes splitted line [line2]</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">found</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">):</span>
		<span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="isSubset">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.isSubset">[docs]</a>
<span class="k">def</span> <span class="nf">isSubset</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="n">supernet</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Check if provided prefix is part of provided supernet or not.</span>

<span class="sd">	Args:</span>
<span class="sd">		pfx (str): subnet</span>
<span class="sd">		supernet (str): supernet</span>

<span class="sd">	Raises:</span>
<span class="sd">		Exception: if an input error occur</span>

<span class="sd">	Returns:</span>
<span class="sd">		bool: True if subnet is part of supernet else False</span>
<span class="sd">	&quot;&quot;&quot;</span>    	
	<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">)):</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUTERROR&quot;</span><span class="p">)</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">supernet</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">)):</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUTERROR&quot;</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">supernet</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="n">supernet</span> <span class="o">=</span> <span class="n">addressing</span><span class="p">(</span><span class="n">supernet</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="n">pfx</span> <span class="o">=</span> <span class="n">addressing</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">supernet</span><span class="o">.</span><span class="n">mask</span> <span class="o">&lt;=</span> <span class="n">pfx</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span>
		<span class="n">supernet_bin</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="n">supernet</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
		<span class="n">pfx_bin</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="n">pfx</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">supernet_bin</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">supernet</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">pfx_bin</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">supernet</span><span class="o">.</span><span class="n">mask</span><span class="p">]:</span>
			<span class="k">return</span> <span class="kc">True</span>
	<span class="k">return</span> <span class="kc">False</span>	</div>



<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># Validation Class - doing subnet validation and version detection</span>
<span class="c1"># ----------------------------------------------------------------------------</span>
<div class="viewcode-block" id="Validation">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Validation">[docs]</a>
<span class="k">class</span> <span class="nc">Validation</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;ip-subnet validation class, provide ipv4 or ipv6 subnet with &quot;/&quot; mask</span>

<span class="sd">	Args:</span>
<span class="sd">		subnet (str): ipv4 or ipv6 subnet with &quot;/&quot; mask</span>

<span class="sd">	&quot;&quot;&quot;</span>    	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subnet</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialise the validation.</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="n">subnet</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_version</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">validated</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_check_ip_object</span><span class="p">()</span>


	<span class="k">def</span> <span class="nf">_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;ip version number</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: version number</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">found</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">):</span>
			<span class="k">return</span> <span class="mi">6</span>
		<span class="k">elif</span> <span class="n">STR</span><span class="o">.</span><span class="n">found</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">):</span>
			<span class="k">return</span> <span class="mi">4</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">_check_ip_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;internal checking method</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: _description_</span>

<span class="sd">		Returns:</span>
<span class="sd">			_type_: _description_</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">object_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="n">IPv4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">IPv6</span><span class="p">}</span>
		<span class="n">func_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_v4_input</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_v6_input</span><span class="p">}</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="ow">in</span> <span class="n">object_map</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">validated</span> <span class="o">=</span> <span class="n">func_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">]()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ip_obj</span> <span class="o">=</span> <span class="n">object_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">validated</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip_obj</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip_obj</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated</span><span class="p">:</span>  <span class="k">return</span> <span class="kc">None</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">_invalid_subnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">))</span>

<div class="viewcode-block" id="Validation.check_v4_input">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Validation.check_v4_input">[docs]</a>
	<span class="k">def</span> <span class="nf">check_v4_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;validation of v4 subnet</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="c1"># ~~~~~~~~~ Mask Check ~~~~~~~~~</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="mi">32</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">+</span> <span class="s2">&quot;/32&quot;</span>
		<span class="k">try</span><span class="p">:</span>			
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">&lt;=</span><span class="mi">32</span><span class="p">]):</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mask length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incorrect Mask </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="c1"># ~~~~~~~~~ Subnet Check ~~~~~~~~~</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">octs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">octs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Subnet Length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">octs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">octs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">octs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;=</span><span class="mi">255</span> <span class="p">]):</span>
					<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Subnet Octet </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unidentified Subnet: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Validation.check_v6_input">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Validation.check_v6_input">[docs]</a>
	<span class="k">def</span> <span class="nf">check_v6_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;validation of v6 subnet</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># ~~~~~~~~~ Mask Check ~~~~~~~~~</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="mi">128</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">+</span> <span class="s2">&quot;/128&quot;</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">&lt;=</span><span class="mi">128</span><span class="p">]):</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mask length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1"># ~~~~~~~~~ Subnet ~~~~~~~~~</span>
			<span class="n">sip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
			
			<span class="c1"># ~~~~~~~~~ Check Subnet squeezers ~~~~~~~~~</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sip</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid Subnet, Squeezers detected &gt; 1&quot;</span><span class="p">)</span>
			
			<span class="c1"># ~~~~~~~~~ Subnet Length ~~~~~~~~~</span>
			<span class="n">lsip</span> <span class="o">=</span> <span class="n">sip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">rsip</span> <span class="o">=</span> <span class="n">sip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="n">rsip</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsip</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">rsip</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Subnet Length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lsip</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">rsip</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1"># ~~~~~~~~~ Validate Hextates ~~~~~~~~~</span>
			<span class="k">for</span> <span class="n">hxt</span> <span class="ow">in</span> <span class="n">lsip</span><span class="o">+</span><span class="n">rsip</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">hxt</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span>
						<span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hxt</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Hextate </span><span class="si">{</span><span class="n">hxt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1"># ~~~~~~~~~ All Good ~~~~~~~~~</span>
			<span class="k">return</span> <span class="kc">True</span>

		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unidentified Subnet&quot;</span><span class="p">)</span></div>
</div>


<span class="c1"># --------------------------------------------------------------------------------------------------</span>
<span class="c1"># Parent IP class defining default methods for v4 and v6 objects</span>
<span class="c1"># --------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="IP">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IP">[docs]</a>
<span class="nd">@total_ordering</span>
<span class="k">class</span> <span class="nc">IP</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;defines common properties and methods</span>

<span class="sd">	Raises:</span>
<span class="sd">		Exception: incorrect input</span>

<span class="sd">	Returns:</span>
<span class="sd">		IP: object</span>

<span class="sd">	Yields:</span>
<span class="sd">		IP: object</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subnet</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="n">subnet</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()))</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UnhashableInput: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span>
	<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span>
	<span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span> 
			<span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Excessive Integer Value Assignment not possible. &quot;</span>
				<span class="s2">&quot;Use IPv6.len() method to get the length of object&quot;</span>
				<span class="p">)</span>
	<span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span> <span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span>
	<span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span> <span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">&lt;</span> <span class="mi">0</span>
	<span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span> 
		<span class="k">return</span> <span class="p">(</span><span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span>
			<span class="ow">and</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
	<span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;add n-ip&#39;s to given subnet and return udpated subnet&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">):</span>
			<span class="n">summary</span> <span class="o">=</span> <span class="n">get_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">get_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
					<span class="s2">&quot;Inconsistant subnets cannot be added &quot;</span>
					<span class="s2">&quot;and &gt;2 instances of IPv4/IPv6 Object add not allowed. please check inputs or &quot;</span>
					<span class="s2">&quot;Use &#39;get_summaries&#39; function instead&quot;</span>
					<span class="p">)</span>
	<span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
	<span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sub_subnets</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
	<span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnetips</span><span class="p">()</span>
	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">+</span><span class="n">n</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnetips</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">stop</span><span class="p">):</span>
				<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
			<span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
	<span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfx</span><span class="p">):</span> <span class="n">isSubset</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

	<span class="c1"># get n-number of subnets of given super-net</span>
	<span class="k">def</span> <span class="nf">_sub_subnets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
		<span class="n">_iplst</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">x1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bit_length</span><span class="p">)):</span>
			<span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">x1</span>
			<span class="k">if</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span> <span class="k">break</span>
		<span class="n">_nsm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">+</span> <span class="n">i1</span>
		<span class="n">_nip</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">_bcip</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">_iis</span> <span class="o">=</span> <span class="p">(</span><span class="n">_bcip</span> <span class="o">-</span> <span class="n">_nip</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">p</span>
		<span class="k">for</span> <span class="n">i2</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">_nip</span><span class="p">,</span> <span class="n">_bcip</span><span class="p">,</span> <span class="n">_iis</span><span class="p">)):</span>
			<span class="n">_iplst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="n">i2</span><span class="o">*</span><span class="n">_iis</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">_nsm</span><span class="p">))</span>
		<span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_iplst</span><span class="p">)</span>

	<span class="c1"># yields IP Address(es) of the provided subnet</span>
	<span class="k">def</span> <span class="nf">_subnetips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="n">_nip</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">_bcip</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">_bcip</span> <span class="o">=</span> <span class="n">_nip</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">begin</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i2</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">_nip</span><span class="p">,</span> <span class="n">_bcip</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">begin</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>  <span class="n">i2</span> <span class="o">=</span> <span class="n">i2</span><span class="o">+</span><span class="n">begin</span>
			<span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span></div>




<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># IP Subnet (IPv6) class </span>
<span class="c1"># ----------------------------------------------------------------------------</span>

<div class="viewcode-block" id="IPv6">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6">[docs]</a>
<span class="k">class</span> <span class="nc">IPv6</span><span class="p">(</span><span class="n">IP</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;IPv6 object</span>

<span class="sd">	Args:</span>
<span class="sd">		subnet (str): ipv6 subnet with mask.</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="n">version</span> <span class="o">=</span> <span class="mi">6</span>
	<span class="n">bit_length</span> <span class="o">=</span> <span class="mi">128</span>

	<span class="c1"># Object Initializer</span>
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subnet</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;initialize the IPv6 object for provided v6 subnet</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_network_ip</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">__actualv6subnet</span> <span class="o">=</span> <span class="kc">False</span>				<span class="c1"># breaked subnet expanded</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_network_address_bool</span> <span class="o">=</span> <span class="kc">False</span>			<span class="c1"># Subnet zero available/not</span>

<div class="viewcode-block" id="IPv6.len">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.len">[docs]</a>
	<span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Subnet size</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: count of ip in this subnet </span>
<span class="sd">		&quot;&quot;&quot;</span>	
		<span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()))</span> <span class="o">-</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span></div>


	<span class="c1"># ------------------------------------------------------------------------</span>
	<span class="c1"># Private Methods</span>
	<span class="c1"># ------------------------------------------------------------------------</span>

	<span class="c1"># update Subnet to actual length / expand zeros </span>
	<span class="k">def</span> <span class="nf">_to_actualsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
		<span class="c1"># if not self.subnet: return False</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span>

	<span class="c1"># IP Portion of Input</span>
	<span class="k">def</span> <span class="nf">_network_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NoValidIPv6SubnetDetected: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="c1"># Padding subnet with &quot;:0&quot; or &quot;:ffff&quot;</span>
	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_pad</span><span class="p">(</span><span class="n">padwhat</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">counts</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">padwhat</span>
		<span class="k">return</span> <span class="n">s</span>

	<span class="c1"># Return a specific Hextate (hexTnum) from IPV6 address</span>
	<span class="k">def</span> <span class="nf">_get_hext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexTnum</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>	<span class="k">return</span> <span class="n">get_hext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">,</span> <span class="n">hexTnum</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

	<span class="c1"># Return Number of Network Hextates (hxts) from IPV6 address</span>
	<span class="k">def</span> <span class="nf">_get_hextates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hxts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
		<span class="n">ox</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hxts</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
			<span class="n">ox</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">string_concate</span><span class="p">(</span><span class="n">ox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hext</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">),</span> <span class="n">conj</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">ox</span><span class="o">+</span><span class="s2">&quot;:&quot;</span>

	<span class="c1"># NETWORK / BC Address Calculation : addtype = &#39;NET&#39; , &#39;BC&#39;</span>
	<span class="k">def</span> <span class="nf">_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addtype</span><span class="o">=</span><span class="s1">&#39;NET&#39;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_to_actualsize</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">&lt;</span><span class="mi">128</span><span class="p">:</span>	 <span class="c1"># Non host-only subnets</span>
			<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">addtype</span> <span class="o">==</span> <span class="s1">&#39;NET&#39;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
			<span class="n">padIP</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="k">if</span> <span class="n">addtype</span> <span class="o">==</span> <span class="s1">&#39;NET&#39;</span> <span class="k">else</span> <span class="s1">&#39;ffff&#39;</span>
			<span class="p">(</span><span class="n">asilast</span><span class="p">,</span> <span class="n">avs</span><span class="p">)</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[])</span>
			<span class="n">fixedOctets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">//</span><span class="mi">16</span>

			<span class="c1">## get full list of available subnets in selected Hexate.</span>
			<span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">65536</span><span class="p">:</span>	
				<span class="n">asilast</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
				<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">16</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">-</span><span class="p">((</span><span class="n">fixedOctets</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="p">))))</span>

			<span class="c1">## check avlbl subnet and choose less then given one.</span>
			<span class="k">for</span> <span class="n">netx</span> <span class="ow">in</span> <span class="n">asilast</span><span class="p">:</span>		
				<span class="n">avs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_hextates</span><span class="p">(</span><span class="n">fixedOctets</span><span class="p">)</span>  
										<span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">netx</span><span class="p">))[</span><span class="mi">2</span><span class="p">:])</span>
				<span class="k">if</span> <span class="n">addtype</span> <span class="o">==</span><span class="s1">&#39;BC&#39;</span><span class="p">:</span>
					<span class="n">last_subnet</span> <span class="o">=</span> <span class="n">avs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_hext</span><span class="p">(</span><span class="n">fixedOctets</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">netx</span><span class="p">:</span>
					<span class="k">break</span>
				<span class="k">if</span> <span class="n">addtype</span> <span class="o">==</span><span class="s1">&#39;NET&#39;</span><span class="p">:</span>
					<span class="n">last_subnet</span> <span class="o">=</span> <span class="n">avs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

			<span class="c1">## Return subnet by padding zeros.</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fixedOctets</span> <span class="o">=</span> <span class="n">fixedOctets</span>
			<span class="n">nt</span> <span class="o">=</span> <span class="n">last_subnet</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_pad</span><span class="p">(</span><span class="n">padIP</span><span class="p">,</span> <span class="mi">7</span><span class="o">-</span><span class="n">fixedOctets</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">nt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span><span class="p">:</span> <span class="n">nt</span> <span class="o">=</span> <span class="n">nt</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
			<span class="k">return</span> <span class="n">nt</span>

		<span class="k">else</span><span class="p">:</span>									<span class="c1"># host-only subnet</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span>

	<span class="k">def</span> <span class="nf">_add_ip_to_network_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;Adds num of IP to Network IP and return address&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_network_address</span>
		<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnet_zero</span>
		<span class="k">if</span> <span class="n">_</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span>
		<span class="n">_7o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hextates</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
		<span class="n">_8o</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_hext</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">num</span>
		<span class="k">return</span> <span class="n">_7o</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">_8o</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">_broadcast_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span><span class="p">(</span><span class="n">addtype</span><span class="o">=</span><span class="s1">&#39;BC&#39;</span><span class="p">)</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">_network_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;Returns only NETWORK ADDRESS for given subnet&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_address_bool</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_subnet_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span><span class="p">(</span><span class="n">addtype</span><span class="o">=</span><span class="s1">&#39;NET&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_network_address_bool</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subnet_zero</span>
	<span class="n">NetworkAddress</span> <span class="o">=</span> <span class="n">_network_address</span>


	<span class="c1"># ------------------------------------------------------------------------</span>
	<span class="c1"># Public Methods </span>
	<span class="c1"># ------------------------------------------------------------------------</span>

<div class="viewcode-block" id="IPv6.get_hext">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.get_hext">[docs]</a>
	<span class="k">def</span> <span class="nf">get_hext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hexTnum</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get a specific Hextate value from IPV6 address</span>
<span class="sd">		same as: getHext</span>

<span class="sd">		Args:</span>
<span class="sd">			hexTnum (int): hextate number</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: hextate value</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hext</span><span class="p">(</span><span class="n">hexTnum</span><span class="p">)</span></div>

	<span class="n">getHext</span> <span class="o">=</span> <span class="n">get_hext</span>

<div class="viewcode-block" id="IPv6.subnet_zero">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.subnet_zero">[docs]</a>
	<span class="k">def</span> <span class="nf">subnet_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Network Address (subnet zero) with/without mask for given subnet</span>
<span class="sd">		same as: NetworkIP</span>

<span class="sd">		Args:</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to True.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: Network Address</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="n">withMask</span> <span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_address</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_address</span></div>

	<span class="n">NetworkIP</span> <span class="o">=</span> <span class="n">subnet_zero</span>

<div class="viewcode-block" id="IPv6.broadcast_address">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.broadcast_address">[docs]</a>
	<span class="k">def</span> <span class="nf">broadcast_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Broadcast Address with/without mask for given subnet</span>
<span class="sd">		same as: BroadcastIP</span>

<span class="sd">		Args:</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to True.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: Broadcast Address</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">withMask</span> <span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broadcast_address</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broadcast_address</span></div>

	<span class="n">BroadcastIP</span> <span class="o">=</span> <span class="n">broadcast_address</span>

<div class="viewcode-block" id="IPv6.n_thIP">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.n_thIP">[docs]</a>
	<span class="k">def</span> <span class="nf">n_thIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;n-th IP with/without mask from given subnet</span>

<span class="sd">		Args:</span>
<span class="sd">			n (int, optional): n-th ip. Defaults to 0.</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to False.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: nth IP Address string</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ip_to_network_address</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span>
		<span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimalMask</span>
		<span class="k">return</span> <span class="n">ip</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">mask</span> <span class="k">if</span> <span class="n">withMask</span> <span class="k">else</span> <span class="n">ip</span></div>


	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">expanded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;expanded format of ipv6 address.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: expanded format ipv6 address.</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">decimalMask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;decimal mask of given subnet</span>
<span class="sd">		same as: decmask</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
	<span class="n">decmask</span> <span class="o">=</span> <span class="n">decimalMask</span>

	<span class="c1">## - NA - for IPv6 ##</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">binmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Not Implemented for IPv6 &quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="kc">None</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">invmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Not Implemented for IPv6 &quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="kc">None</span>
<div class="viewcode-block" id="IPv6.ipdecmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.ipdecmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipdecmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;nth ip with decimal mask&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="IPv6.ipbinmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.ipbinmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipbinmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Not Implemented for IPv6 &quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="IPv6.ipinvmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv6.ipinvmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipinvmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> 
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Not Implemented for IPv6 &quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="kc">None</span></div>
</div>



<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># IPv4 Subnet (IPv4) class </span>
<span class="c1"># ----------------------------------------------------------------------------</span>
<div class="viewcode-block" id="IPv4">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4">[docs]</a>
<span class="k">class</span> <span class="nc">IPv4</span><span class="p">(</span><span class="n">IP</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;IPv4 object</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="n">version</span> <span class="o">=</span> <span class="mi">4</span>
	<span class="n">bit_length</span> <span class="o">=</span> <span class="mi">32</span>

	<span class="c1"># ------------------------------------------------------------------------</span>
	<span class="c1"># Private methods / Properties</span>
	<span class="c1"># ------------------------------------------------------------------------</span>

	<span class="c1"># binary mask return property</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">_binmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">pone</span> <span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
			<span class="n">pzero</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">pone</span><span class="o">+</span><span class="n">pzero</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="c1"># Inverse mask return property</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">_invmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">pone</span> <span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
			<span class="n">pzero</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">pone</span><span class="o">+</span><span class="n">pzero</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_pad_zeros</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span> 
		<span class="k">return</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">34</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bins</span><span class="p">)))</span><span class="o">+</span><span class="n">bins</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_octets_bin2dec</span><span class="p">(</span><span class="n">binnet</span><span class="p">):</span> 
		<span class="k">return</span>  <span class="p">[</span><span class="n">bin2dec</span><span class="p">(</span><span class="n">binnet</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="p">]</span>
	<span class="k">def</span> <span class="nf">_bin_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binone</span><span class="p">,</span> <span class="n">bintwo</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pad_zeros</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">binone</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">bintwo</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
	<span class="k">def</span> <span class="nf">_bin_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binone</span><span class="p">,</span> <span class="n">bintwo</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pad_zeros</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">binone</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="nb">int</span><span class="p">(</span><span class="n">bintwo</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>

	<span class="c1"># ------------------------------------------------------------------------</span>
	<span class="c1"># Available Methods &amp; Public properties of class</span>
	<span class="c1"># ------------------------------------------------------------------------</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">ip_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;distance of provided ip from its network number</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: difference of ips from provided ip to its network number</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">selfinteger</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">networkinteger</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">())))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">selfinteger</span> <span class="o">-</span> <span class="n">networkinteger</span>

<div class="viewcode-block" id="IPv4.expand">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.expand">[docs]</a>
	<span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_mask</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;expand the provided subnet to given bigger size subnet. provided subnet mask `new_mask` should be less in number to the existing subnet mask in such case.</span>

<span class="sd">		Args:</span>
<span class="sd">			new_mask (int): subnet mask to which subnet to be expanded.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: expanded subnet string value</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_mask</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
			<span class="k">raise</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mask provided </span><span class="si">{</span><span class="n">new_mask</span><span class="si">}</span><span class="s2">.  Expected integer got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_mask</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">new_mask</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span>
			<span class="n">_ns</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">(</span><span class="n">withMask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">new_mask</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">_ns</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()</span></div>


<div class="viewcode-block" id="IPv4.subnet_zero">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.subnet_zero">[docs]</a>
	<span class="k">def</span> <span class="nf">subnet_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Network IP Address (subnet zero) of subnet from provided IP/Subnet.</span>
<span class="sd">		same as: NetworkIP</span>

<span class="sd">		Args:</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to True.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: Network address</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
			<span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binmask</span>
			<span class="n">net</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">list_to_octet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_octets_bin2dec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bin_and</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">bm</span> <span class="p">)))</span>
			<span class="k">if</span> <span class="n">withMask</span> <span class="p">:</span>
				<span class="k">return</span> <span class="n">net</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">net</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span></div>

	<span class="n">NetworkIP</span> <span class="o">=</span> <span class="n">subnet_zero</span>

<div class="viewcode-block" id="IPv4.broadcast_address">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.broadcast_address">[docs]</a>
	<span class="k">def</span> <span class="nf">broadcast_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Broadcast IP Address of subnet from provided IP/Subnet</span>
<span class="sd">		same as: BroadcastIP</span>

<span class="sd">		Args:</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to False.</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: broadcast ip</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
			<span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invmask</span>
			<span class="n">bc</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">list_to_octet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_octets_bin2dec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bin_or</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">im</span> <span class="p">)))</span>
			<span class="k">if</span> <span class="n">withMask</span> <span class="p">:</span>
				<span class="k">return</span> <span class="n">bc</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">bc</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span></div>

	<span class="n">BroadcastIP</span> <span class="o">=</span> <span class="n">broadcast_address</span>

<div class="viewcode-block" id="IPv4.n_thIP">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.n_thIP">[docs]</a>
	<span class="k">def</span> <span class="nf">n_thIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">withMask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">summary_calc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;n-th IP Address of subnet from provided IP/Subnet</span>

<span class="sd">		Args:</span>
<span class="sd">			n (int, optional): number of ip. Defaults to 0.</span>
<span class="sd">			withMask (bool, optional): return with mask. Defaults to False.</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: for address out of range</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: nth ip address</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
			<span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binmask</span>
			<span class="n">addedbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pad_zeros</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bin_and</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">bm</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">n</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">addedbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pad_zeros</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="mi">2</span> <span class="p">)</span><span class="o">+</span><span class="n">n</span><span class="p">))</span>

		<span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">([</span><span class="n">addedbin</span> <span class="o">&gt;</span> <span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()),</span> 
				<span class="n">addedbin</span> <span class="o">&lt;</span> <span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">())])</span> <span class="ow">and</span> 
			<span class="ow">not</span> <span class="n">summary_calc</span>
			<span class="p">):</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Address Out of Range&quot;</span><span class="p">)</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="n">ip</span> <span class="o">=</span> <span class="n">LST</span><span class="o">.</span><span class="n">list_to_octet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_octets_bin2dec</span><span class="p">(</span><span class="n">addedbin</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">withMask</span> <span class="p">:</span>
				<span class="k">return</span> <span class="n">ip</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">ip</span></div>


	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">decmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;Decimal Mask from provided IP/Subnet - Numeric/Integer&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
	<span class="n">decimalMask</span> <span class="o">=</span> <span class="n">decmask</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">binmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;Binary Mask from provided IP/Subnet&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="n">LST</span><span class="o">.</span><span class="n">list_to_octet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_octets_bin2dec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_binmask</span><span class="p">))</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">invmask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&#39;&#39;&#39;Inverse Mask from provided IP/Subnet&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="n">LST</span><span class="o">.</span><span class="n">list_to_octet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_octets_bin2dec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_invmask</span><span class="p">))</span>

<div class="viewcode-block" id="IPv4.ipdecmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.ipdecmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipdecmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;IP with Decimal Mask for provided IP/Subnet,</span>

<span class="sd">		Args:</span>
<span class="sd">			n (int, optional): n-th ip of subnet will appear in output if provided. Defaults to 0.</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: invalid input</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: ipaddress/mask</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid Input : detected&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="IPv4.ipbinmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.ipbinmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipbinmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;IP with Binary Mask for provided IP/Subnet,</span>

<span class="sd">		Args:</span>
<span class="sd">			n (int, optional): n-th ip of subnet will appear in output if provided,. Defaults to 0.</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: invalid input</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: ip_address subnet_mask</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">binmask</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid Input : detected&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="IPv4.ipinvmask">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.ipinvmask">[docs]</a>
	<span class="k">def</span> <span class="nf">ipinvmask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;IP with Inverse Mask for provided IP/Subnet,</span>

<span class="sd">		Args:</span>
<span class="sd">			n (int, optional): n-th ip of subnet will appear in output if provided. Defaults to 0.</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: invalid input</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: ip_address inverse_mask</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">invmask</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid Input : detected&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="IPv4.to_decimal">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.to_decimal">[docs]</a>
	<span class="k">def</span> <span class="nf">to_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;decimal number of subnet number</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: integer/decimal value</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="n">bin2dec</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ipdecmask</span><span class="p">()))</span></div>


	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;number of ips available in subnet</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: number of ips (subnet size)</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">))</span>

<div class="viewcode-block" id="IPv4.ipn">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.ipn">[docs]</a>
	<span class="k">def</span> <span class="nf">ipn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get the ip number for provided ip address in the current subnet</span>

<span class="sd">		Args:</span>
<span class="sd">			ip (str): ip address</span>

<span class="sd">		Returns:</span>
<span class="sd">			int: ip number</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">child</span> <span class="o">=</span> <span class="n">addressing</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">child</span><span class="o">.</span><span class="n">to_decimal</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_decimal</span><span class="p">()</span></div>


<div class="viewcode-block" id="IPv4.get_octet">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.IPv4.get_octet">[docs]</a>
	<span class="k">def</span> <span class="nf">get_octet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get the desired octet for subnet</span>

<span class="sd">		Args:</span>
<span class="sd">			o (int): octet number</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: octet number</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">return</span> <span class="n">ipv4_octets</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;octets&#39;</span><span class="p">][</span><span class="n">o</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
</div>



<span class="c1"># ------------------------------------------------------------------------------</span>
<span class="c1"># Routes Class</span>
<span class="c1"># ------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="Routes">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Routes">[docs]</a>
<span class="k">class</span> <span class="nc">Routes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Routes Object</span>
<span class="sd">	Either one input is require (route_list, route_file)</span>

<span class="sd">	Args:</span>
<span class="sd">		hostname (str): device hostname</span>
<span class="sd">		route_list (list, optional): cisco sh route command in list format. Defaults to None.</span>
<span class="sd">		route_file (str, optional): text file of sh route output. Defaults to None.</span>
<span class="sd">	&quot;&quot;&quot;</span>    	


	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">route_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">route_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize Route object</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">if</span> <span class="n">route_file</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">route_list</span> <span class="o">=</span> <span class="n">IO</span><span class="o">.</span><span class="n">file_to_list</span><span class="p">(</span><span class="n">route_file</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">__parse</span><span class="p">(</span><span class="n">route_list</span><span class="p">,</span> <span class="n">hostname</span><span class="p">)</span>

	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">routes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

	<span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">yield</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">reversed_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;reversed routes</span>

<span class="sd">		Yields:</span>
<span class="sd">			tuple: route, route_attributes</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">yield</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">routes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;routes with its name&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_items</span>

<div class="viewcode-block" id="Routes.get_prefix_desc">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Routes.get_prefix_desc">[docs]</a>
	<span class="k">def</span> <span class="nf">get_prefix_desc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;prefix description if available or returns it for default route</span>

<span class="sd">		Args:</span>
<span class="sd">			prefix (str): prefix to check</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: input error</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: prefix remark/description if any</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="n">pfxlst</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_in_table</span><span class="p">(</span><span class="n">addressing</span><span class="p">(</span><span class="n">prefix</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">pfxlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
				<span class="k">return</span> <span class="n">pfxlst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prefixesNotinAnySubnet: Error&quot;</span><span class="p">)</span>
				<span class="k">return</span> <span class="kc">None</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">):</span>
			<span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_in_table</span><span class="p">(</span><span class="n">prefix</span><span class="o">.</span><span class="n">subnet</span><span class="p">)</span>
			<span class="n">pfxlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">set</span><span class="p">)):</span>
			<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prefix</span><span class="p">:</span>
				<span class="n">px</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_prefix_desc</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">px</span><span class="p">:</span>
					<span class="n">pfxlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUTERROR&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pfxlst</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">pfxlst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prefixesNotinSamesubnet: Error&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Routes.inTable">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Routes.inTable">[docs]</a>
	<span class="k">def</span> <span class="nf">inTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;check if prefix is in routes table, return for default-route otherwise</span>

<span class="sd">		Args:</span>
<span class="sd">			prefix (str): prefix to check</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool: prefix in table or not</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_in_table</span><span class="p">(</span><span class="n">prefix</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="Routes.outerPrefix">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Routes.outerPrefix">[docs]</a>
	<span class="k">def</span> <span class="nf">outerPrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;check and return parent subnet of prefix in routes table, default-route otherwise</span>

<span class="sd">		Args:</span>
<span class="sd">			prefix (str): prefix to check</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: matching prefix/supernet</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_in_table</span><span class="p">(</span><span class="n">prefix</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span></div>


	<span class="c1">######################### LOCAL FUNCTIONS #########################</span>

	<span class="c1"># Helper for inTable and outerPrefix</span>
	<span class="k">def</span> <span class="nf">__check_in_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">IPv4</span><span class="p">)):</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUTERROR&quot;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed_table</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;0.0.0.0/0&#39;</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">isSubset</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
				<span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
				<span class="k">break</span>
		<span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;0.0.0.0/0&#39;</span><span class="p">)</span>

	<span class="c1"># set routes in dictionary/ parser</span>
	<span class="k">def</span> <span class="nf">__parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route_list</span><span class="p">,</span> <span class="n">hostname</span><span class="p">):</span>
		<span class="n">headers</span> <span class="o">=</span> <span class="p">(</span>
		<span class="s2">&quot;L - local&quot;</span><span class="p">,</span> <span class="s2">&quot;C - connected&quot;</span><span class="p">,</span> <span class="s2">&quot;S - static&quot;</span><span class="p">,</span> <span class="s2">&quot;R - RIP&quot;</span><span class="p">,</span> <span class="s2">&quot;M - mobile&quot;</span><span class="p">,</span> <span class="s2">&quot;B - BGP&quot;</span><span class="p">,</span>
		<span class="s2">&quot;D - EIGRP&quot;</span><span class="p">,</span> <span class="s2">&quot;EX - EIGRP external&quot;</span><span class="p">,</span> <span class="s2">&quot;O - OSPF&quot;</span><span class="p">,</span> <span class="s2">&quot;IA - OSPF inter area&quot;</span><span class="p">,</span> 
		<span class="s2">&quot;N1 - OSPF NSSA external type 1&quot;</span><span class="p">,</span> <span class="s2">&quot;N2 - OSPF NSSA external type 2&quot;</span><span class="p">,</span>
		<span class="s2">&quot;E1 - OSPF external type 1&quot;</span><span class="p">,</span> <span class="s2">&quot;E2 - OSPF external type 2&quot;</span><span class="p">,</span> <span class="s2">&quot;V - VPN&quot;</span><span class="p">,</span>
		<span class="s2">&quot;i - IS-IS&quot;</span><span class="p">,</span> <span class="s2">&quot;su - IS-IS summary&quot;</span><span class="p">,</span> <span class="s2">&quot;L1 - IS-IS level-1&quot;</span><span class="p">,</span> <span class="s2">&quot;L2 - IS-IS level-2&quot;</span><span class="p">,</span>
		<span class="s2">&quot;ia - IS-IS inter area&quot;</span><span class="p">,</span> <span class="s2">&quot;* - candidate default&quot;</span><span class="p">,</span> <span class="s2">&quot;U - per-user static route&quot;</span><span class="p">,</span>
		<span class="s2">&quot;o - ODR&quot;</span><span class="p">,</span> <span class="s2">&quot;P - periodic downloaded static route&quot;</span><span class="p">,</span> <span class="s2">&quot;+ - replicated route&quot;</span><span class="p">,</span>
		<span class="s2">&quot;Gateway of last resort&quot;</span>
		<span class="p">)</span>
		<span class="n">op_items</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">route_list</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">is_blank_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">is_hostname_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">hostname</span><span class="p">):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">STR</span><span class="o">.</span><span class="n">find_any</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">isSplittedRoute</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">spl</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="n">isSplittedRoute</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">spl</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span>
			<span class="n">spl</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;0.0.0.0 0.0.0.0&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">op_items</span><span class="p">[</span><span class="s1">&#39;0.0.0.0/0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">replace_dual_and_split</span><span class="p">(</span><span class="n">spl</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">continue</span>
			<span class="n">route</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">replace_dual_and_split</span><span class="p">(</span><span class="n">spl</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">routeMask</span> <span class="o">=</span> <span class="n">binsubnet</span><span class="p">(</span><span class="n">STR</span><span class="o">.</span><span class="n">replace_dual_and_split</span><span class="p">(</span><span class="n">spl</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="n">spl</span><span class="p">)</span>
			<span class="n">routeDesc</span> <span class="o">=</span> <span class="n">STR</span><span class="o">.</span><span class="n">replace_dual_and_split</span><span class="p">(</span><span class="n">spl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">op_items</span><span class="p">[</span><span class="n">route</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">routeMask</span><span class="p">)]</span> <span class="o">=</span> <span class="n">routeDesc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_op_items</span> <span class="o">=</span> <span class="n">op_items</span></div>



<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># Prefixes summarization class </span>
<span class="c1"># ----------------------------------------------------------------------------</span>

<span class="n">MAX_RECURSION_DEPTH</span> <span class="o">=</span> <span class="mi">100</span>		<span class="c1"># default recursion depth, increase if exceeding and need to go deep more.</span>
<div class="viewcode-block" id="Summary">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Summary">[docs]</a>
<span class="k">class</span> <span class="nc">Summary</span><span class="p">(</span><span class="n">IPv4</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;Defines Summaries of prefixes</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1"># __slots__ = [&#39;networks&#39;, &#39;summaries&#39;, &#39;del_eligibles&#39;,&#39;mask&#39;,&#39;first&#39;,&#39;second&#39;,</span>
	<span class="c1"># 	&#39;first_len&#39;,&#39;second_len&#39;,&#39;total&#39;]</span>

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>		
<span class="w">		</span><span class="sd">&quot;&quot;&quot;initialize object with provided args=prefixes</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">networks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
		<span class="n">args</span> <span class="o">=</span> <span class="n">sorted_v4_addresses</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
					<span class="n">arg</span><span class="o">=</span><span class="n">IPv4</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">summaries</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">networks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">networks</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_update_networks</span><span class="p">()</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;set of summary addresses</span>

<span class="sd">		Returns:</span>
<span class="sd">			set: summaries</span>
<span class="sd">		&quot;&quot;&quot;</span>    		
		<span class="k">for</span> <span class="n">pfx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="n">pfx</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">)</span>

	<span class="c1"># provided networks validation, remove non-validated networks.</span>
	<span class="k">def</span> <span class="nf">_validate_and_update_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">networks</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">Validation</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">network</span><span class="p">))</span><span class="o">.</span><span class="n">validated</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InvalidSubnetDetected-Removed: </span><span class="si">{</span><span class="n">network</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>

	<span class="c1"># kick</span>
<div class="viewcode-block" id="Summary.calculate">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Summary.calculate">[docs]</a>
	<span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;calculate summaries for provided networks</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">prev_network</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">networks</span><span class="p">:</span>
			<span class="n">_sumy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">prev_network</span><span class="p">,</span> <span class="n">network</span><span class="p">)</span>
			<span class="n">prev_network</span> <span class="o">=</span> <span class="n">_sumy</span> <span class="k">if</span> <span class="n">_sumy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">network</span>
			<span class="k">if</span> <span class="n">_sumy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
				<span class="c1"># prev_network = _sumy</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prev_network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> 
					<span class="n">_sumy</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">_sumy</span><span class="p">)</span>
					<span class="n">prev_network</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">prev_network</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_sumy</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">network</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">summaries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">calc_subset_prefixes</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">remove_subset_prefixes</span><span class="p">()</span></div>


<div class="viewcode-block" id="Summary.remove_subset_prefixes">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Summary.remove_subset_prefixes">[docs]</a>
	<span class="k">def</span> <span class="nf">remove_subset_prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;revmoes subset of prefixes from already calculated summary</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">for</span> <span class="n">pfx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">del_eligibles</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span></div>


<div class="viewcode-block" id="Summary.calc_subset_prefixes">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Summary.calc_subset_prefixes">[docs]</a>
	<span class="k">def</span> <span class="nf">calc_subset_prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;calculates subbsets of prefixes to identify delete eligibles</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">del_eligibles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pfx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">varify_pfx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span> <span class="k">continue</span>
				<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">varify_pfx</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isSubset</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="n">varify_pfx</span><span class="p">):</span>
					<span class="n">del_eligibles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">del_eligibles</span> <span class="o">=</span> <span class="n">del_eligibles</span></div>


<div class="viewcode-block" id="Summary.summary">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Summary.summary">[docs]</a>
	<span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;summary of given two network addresses s1 and s2</span>

<span class="sd">		Args:</span>
<span class="sd">			s1 (IPv4): IPv4 object1</span>
<span class="sd">			s2 (IPv4): IPv4 object2</span>

<span class="sd">		Returns:</span>
<span class="sd">			_type_: _description_</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">if</span> <span class="n">s2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">s1</span>
		<span class="k">if</span> <span class="n">s1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">s2</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_are_equal</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="n">s1</span>
		<span class="n">big_subnet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_any_subset</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">big_subnet</span><span class="p">:</span> <span class="k">return</span> <span class="n">big_subnet</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_sequnce_it</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_local_vars</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contigious</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_immidiate</span><span class="p">():</span> <span class="k">return</span> <span class="kc">None</span>
		<span class="n">summary_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">summary_ip</span> <span class="k">if</span> <span class="n">Validation</span><span class="p">(</span><span class="n">summary_ip</span><span class="p">)</span><span class="o">.</span><span class="n">validated</span> <span class="k">else</span> <span class="kc">None</span></div>


	<span class="c1"># Order the subnet sequencially.</span>
	<span class="k">def</span> <span class="nf">_sequnce_it</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()),</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">binsubnet</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()),</span> <span class="mi">2</span> <span class="p">):</span>
			<span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span> 
		<span class="k">else</span><span class="p">:</span> 
			<span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span>

	<span class="c1"># defining some local variables</span>
	<span class="k">def</span> <span class="nf">_local_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># ---------- set local vars ------------------</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">first_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">second_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">first_len</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_len</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_len</span> <span class="k">else</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">second_len</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>			<span class="c1"># tantative summary mask</span>
		<span class="c1"># --------------------------------------------</span>

	<span class="c1"># are provided two prefixes equal or not, check boolean</span>
	<span class="k">def</span> <span class="nf">_are_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="n">s1</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">mask</span> <span class="ow">and</span> <span class="n">s1</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()</span>

	<span class="c1"># is s1 part of s2 ?</span>
	<span class="k">def</span> <span class="nf">_is_any_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
		<span class="p">(</span><span class="n">big_subnet</span><span class="p">,</span> <span class="n">small_subnet</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span> <span class="k">if</span> <span class="n">s1</span><span class="o">.</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="n">s2</span><span class="o">.</span><span class="n">mask</span> <span class="k">else</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
		<span class="n">is_part</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">33</span><span class="p">):</span>
			<span class="n">no_of_subnets</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">power</span><span class="p">)</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">portions</span> <span class="o">=</span> <span class="n">big_subnet</span><span class="o">/</span><span class="n">no_of_subnets</span>
			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
				<span class="k">break</span>
			<span class="k">if</span> <span class="n">small_subnet</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">()</span> <span class="ow">in</span> <span class="n">portions</span><span class="p">:</span>
				<span class="n">is_part</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="k">break</span>
		<span class="k">return</span> <span class="n">big_subnet</span> <span class="k">if</span> <span class="n">is_part</span> <span class="k">else</span> <span class="kc">None</span>

	<span class="c1"># a condition</span>
	<span class="k">def</span> <span class="nf">_contigious</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># condition 1 - next ip of subnet 1 should be network ip of subnet 2 / Verfications</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first_len</span><span class="p">,</span> <span class="n">summary_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">NetworkIP</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

	<span class="c1"># a more condition</span>
	<span class="k">def</span> <span class="nf">_immidiate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># condition 2 - length subnet 1 + lenght subnet 2 == bc ip of subnet 2</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">n_thIP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">summary_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">broadcast_address</span><span class="p">()</span></div>


<span class="c1"># =====================================================================================================</span>

<div class="viewcode-block" id="Allocations">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations">[docs]</a>
<span class="k">class</span> <span class="nc">Allocations</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Store Allocations of subnets</span>
<span class="sd">	&quot;&quot;&quot;</span>	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ranges</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">what_list</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">increamental</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">allocation_type</span> <span class="o">=</span> <span class="s1">&#39;additive&#39;</span>   <span class="c1">## options: &#39;comparative&#39;, &#39;override&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">display_warning</span> <span class="o">=</span> <span class="kc">True</span>


<div class="viewcode-block" id="Allocations.add_prefix">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations.add_prefix">[docs]</a>
	<span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfx</span><span class="p">,</span> <span class="n">forwhat</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;add subnet to allocation. </span>
<span class="sd">		provide additional information forwhat this prefix is allocated</span>

<span class="sd">		Args:</span>
<span class="sd">			pfx (str, IPv4): string or IPv4 subnet object</span>
<span class="sd">			forwhat (str): additional information of range (defaults to None, will be increamental)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">forwhat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">increamental</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="n">forwhat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">increamental</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pfx</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">pfx</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">pfx</span><span class="p">)</span>
		<span class="n">start</span> <span class="o">=</span> <span class="n">pfx</span><span class="o">.</span><span class="n">to_decimal</span><span class="p">()</span>
		<span class="n">cri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_range_in</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfx</span><span class="p">)))</span>
		<span class="k">if</span> <span class="n">cri</span><span class="p">:</span>
			<span class="n">conflict</span> <span class="o">=</span> <span class="n">get_subnet</span><span class="p">(</span><span class="n">cri</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cri</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">cri</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_warning</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prefix </span><span class="si">{</span><span class="n">pfx</span><span class="si">}</span><span class="s2"> is already allocated, or it has clash with existing assignment </span><span class="si">{</span><span class="n">conflict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pfx</span><span class="p">)),</span> <span class="n">forwhat</span><span class="p">)</span></div>


<div class="viewcode-block" id="Allocations.add">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations.add">[docs]</a>
	<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">forwhat</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;add decimal range address to allocation. </span>
<span class="sd">		provide additional information forwhat this prefix is allocated</span>

<span class="sd">		Args:</span>
<span class="sd">			rng (range): decimal range object</span>
<span class="sd">			forwhat (str): additional information of range</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">if</span> <span class="n">forwhat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allocation_type</span> <span class="o">==</span> <span class="s1">&#39;additive&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">],</span> <span class="p">}</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">))</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">allocation_type</span> <span class="o">==</span> <span class="s1">&#39;override&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">allocation_type</span> <span class="o">==</span> <span class="s1">&#39;comparative&#39;</span><span class="p">:</span>
				<span class="c1"># print( int(self.assignment_dict[forwhat]) ,   int(self.get_subnet(rng).split(&quot;/&quot;)) )</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">])</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">))</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_warning</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subneet already found same or bigger, comparative allocations will not add&quot;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">)}</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">],</span> <span class="nb">set</span><span class="p">):</span>
					<span class="k">for</span> <span class="n">ad_fw</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]:</span>
						<span class="k">if</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">ad_fw</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">))</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
							<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_warning</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subneet already found same or bigger, comparative allocations will not add&quot;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">))</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">what_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forwhat</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">assignment_dict</span><span class="p">[</span><span class="n">forwhat</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span></div>


<div class="viewcode-block" id="Allocations.check_ip_in">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations.check_ip_in">[docs]</a>
	<span class="k">def</span> <span class="nf">check_ip_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verify if provided ip is falling in the already allocated range(s)</span>

<span class="sd">		Args:</span>
<span class="sd">			ip (str): single ip address</span>

<span class="sd">		Returns:</span>
<span class="sd">			bool, range: if found returns matched range, else False</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">for</span> <span class="n">range_x</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">range_x</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">range_x</span>
		<span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Allocations.check_range_in">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations.check_range_in">[docs]</a>
	<span class="k">def</span> <span class="nf">check_range_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verify if provided range is part of any allocated range(s)</span>

<span class="sd">		Args:</span>
<span class="sd">			rng (range): decimal range of ips </span>

<span class="sd">		Returns:</span>
<span class="sd">			bool, range: if found returns matched range, else False</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">for</span> <span class="n">range_x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">is_overlap</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">range_x</span><span class="p">):</span>
				<span class="k">return</span> <span class="n">range_x</span>
		<span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Allocations.get_subnet">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocations.get_subnet">[docs]</a>
	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">get_subnet</span><span class="p">(</span><span class="n">rng</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get subnet/mask information for the provided range</span>

<span class="sd">		Args:</span>
<span class="sd">			rng (range): decimal range of ips</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: string representation of subnet/mask for given range</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">sr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rng</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1048576</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">get_subnet</span><span class="p">(</span><span class="n">sr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">sr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">sr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span></div>
</div>




<div class="viewcode-block" id="Subnet_Allocate">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate">[docs]</a>
<span class="k">class</span> <span class="nc">Subnet_Allocate</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Allocate a subnet</span>

<span class="sd">	Args:</span>
<span class="sd">		proposed (str): initial based / proposed ip</span>
<span class="sd">		forwhat (str): additional information of prefix</span>
<span class="sd">	&quot;&quot;&quot;</span>	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proposed</span><span class="p">,</span> <span class="n">forwhat</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;instance initializer</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">proposed</span> <span class="o">=</span> <span class="n">proposed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">forwhat</span> <span class="o">=</span> <span class="n">forwhat</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">get_attributes</span><span class="p">()</span>

<div class="viewcode-block" id="Subnet_Allocate.get_attributes">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate.get_attributes">[docs]</a>
	<span class="k">def</span> <span class="nf">get_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;initial attributes setting</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proposed</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">to_decimal</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">size</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet</span><span class="o">.</span><span class="n">subnet_zero</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">subnet_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_size</span><span class="p">)</span></div>


<div class="viewcode-block" id="Subnet_Allocate.verification">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate.verification">[docs]</a>
	<span class="k">def</span> <span class="nf">verification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;verifications to check range(s)</span>

<span class="sd">		Args:</span>
<span class="sd">			Alloc (Allocations): allocations object</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">checked_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_range</span><span class="p">(</span><span class="n">Alloc</span><span class="p">)</span>
		<span class="n">Alloc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checked_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forwhat</span><span class="p">)</span></div>


<div class="viewcode-block" id="Subnet_Allocate.check_range">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate.check_range">[docs]</a>
	<span class="k">def</span> <span class="nf">check_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;check range against already allocated ranges</span>

<span class="sd">		Args:</span>
<span class="sd">			Alloc (Allocations): allocations object</span>

<span class="sd">		Returns:</span>
<span class="sd">			range: verify if subnet-range is already part of any range</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">current_range_in</span> <span class="o">=</span> <span class="n">Alloc</span><span class="o">.</span><span class="n">check_range_in</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_range</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">current_range_in</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_range</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">sr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">current_range_in</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">subnet_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">sr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">sr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">subnet_size</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_range</span><span class="p">(</span><span class="n">Alloc</span><span class="p">)</span></div>


<div class="viewcode-block" id="Subnet_Allocate.get_subnet">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate.get_subnet">[docs]</a>
	<span class="k">def</span> <span class="nf">get_subnet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get subnet/mask information for the checked range</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: string representation of subnet/mask for given range</span>
<span class="sd">		&quot;&quot;&quot;</span>	
		<span class="n">sr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">checked_range</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1048576</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">get_subnet</span><span class="p">(</span><span class="n">sr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_size</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span></div>



<div class="viewcode-block" id="Subnet_Allocate.get_nxt_subnet_decimal">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Subnet_Allocate.get_nxt_subnet_decimal">[docs]</a>
	<span class="k">def</span> <span class="nf">get_nxt_subnet_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;get next available ip in decimal format</span>

<span class="sd">		Returns:</span>
<span class="sd">			str: dotted decimal format next available ip</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">sr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">checked_range</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">dec2dotted_ip</span><span class="p">(</span><span class="n">sr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Allocate">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocate">[docs]</a>
<span class="k">class</span> <span class="nc">Allocate</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Allocation series</span>

<span class="sd">	Args:</span>
<span class="sd">		size_wise_dict (dict): size wise allocation requirements dictionary</span>
<span class="sd">		base_ip (str): sample base ip</span>
<span class="sd">		what_list_dict_key (str, optional): additional information of prefix. Defaults to None.</span>
<span class="sd">	&quot;&quot;&quot;</span>	

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_wise_dict</span><span class="p">,</span> <span class="n">base_ip</span><span class="p">,</span> <span class="n">what_list_dict_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Alloc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">iterate_base_ip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">size_wise_dict</span> <span class="o">=</span> <span class="n">size_wise_dict</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">base_ip</span> <span class="o">=</span> <span class="n">base_ip</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">iterate_base_ip</span> <span class="o">=</span> <span class="n">iterate_base_ip</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">what_list_dict_key</span> <span class="o">=</span> <span class="n">what_list_dict_key</span>
		<span class="k">if</span> <span class="n">Alloc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Alloc</span> <span class="o">=</span> <span class="n">Allocations</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Alloc</span> <span class="o">=</span> <span class="n">Alloc</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">rearrange_size</span><span class="p">()</span>

<div class="viewcode-block" id="Allocate.rearrange_size">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocate.rearrange_size">[docs]</a>
	<span class="k">def</span> <span class="nf">rearrange_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;rearrange size wise dictionary in reversed order bigger to smaller</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">ssize</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size_wise_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span></div>


<div class="viewcode-block" id="Allocate.subnet_allocate">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocate.subnet_allocate">[docs]</a>
	<span class="k">def</span> <span class="nf">subnet_allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;allocate subnet for given size and prefix information</span>

<span class="sd">		Args:</span>
<span class="sd">			size (int): decimal ip</span>
<span class="sd">			what (str): information of prefix</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="n">msk</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subnet_size_to_mask</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
		<span class="n">SA</span> <span class="o">=</span> <span class="n">Subnet_Allocate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_ip</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">msk</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
		<span class="n">SA</span><span class="o">.</span><span class="n">verification</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Alloc</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterate_base_ip</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">base_ip</span> <span class="o">=</span> <span class="n">SA</span><span class="o">.</span><span class="n">get_nxt_subnet_decimal</span><span class="p">()</span></div>


<div class="viewcode-block" id="Allocate.go_thru_each_section">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocate.go_thru_each_section">[docs]</a>
	<span class="k">def</span> <span class="nf">go_thru_each_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">size_dict_values</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;repeate thru each section (if any) to allocate subnets.</span>

<span class="sd">		Args:</span>
<span class="sd">			size (int): decimal ip</span>
<span class="sd">			size_dict_values (dict, set, list, tuple, str, int): input information on prefix(es)</span>

<span class="sd">		Raises:</span>
<span class="sd">			Exception: _description_</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size_dict_values</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">what_list_dict_key</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;what_list_dict_key is mandatory when providing nested size_wise_dict&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">size_dict_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">what_list_dict_key</span><span class="p">:</span> <span class="k">continue</span>
				<span class="k">for</span> <span class="n">what</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">subnet_allocate</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size_dict_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
			<span class="k">for</span> <span class="n">what</span> <span class="ow">in</span> <span class="n">size_dict_values</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">subnet_allocate</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size_dict_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">subnet_allocate</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size_dict_values</span><span class="p">)</span></div>


<div class="viewcode-block" id="Allocate.start">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.Allocate.start">[docs]</a>
	<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;start executions for all size wise dictionary informations</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssize</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">size_dict_values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_wise_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">size</span><span class="p">:</span> <span class="k">continue</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">go_thru_each_section</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size_dict_values</span><span class="p">)</span></div>


	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;return allocations/assignments dictionary</span>

<span class="sd">		Returns:</span>
<span class="sd">			dict: allocated subnet/prefixes</span>
<span class="sd">		&quot;&quot;&quot;</span>		
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Alloc</span><span class="o">.</span><span class="n">assignment_dict</span></div>


<span class="c1"># =====================================================================================================</span>


<div class="viewcode-block" id="ipv4_octets">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.ipv4_octets">[docs]</a>
<span class="k">def</span> <span class="nf">ipv4_octets</span><span class="p">(</span><span class="n">ip</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;get octets in a list for provided ip/subnet</span>

<span class="sd">	Args:</span>
<span class="sd">		ip (str): ip/mask</span>

<span class="sd">	Returns:</span>
<span class="sd">		dict: dictionary with octets list and mask</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">ip</span><span class="p">:</span> <span class="k">return</span> <span class="p">{}</span>
	<span class="n">fs</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
	<span class="n">octets</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="n">mask</span> <span class="o">=</span> <span class="mi">32</span>
	<span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;octets&#39;</span><span class="p">:</span> <span class="n">octets</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">:</span><span class="n">mask</span> <span class="p">}</span></div>


<span class="c1"># sorted dataframe based on ip octets</span>
<span class="k">def</span> <span class="nf">_get_sorted_dataframe</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">ascending</span><span class="p">,</span> <span class="n">byip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bymask</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
		<span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
	<span class="n">df</span><span class="p">[</span><span class="s1">&#39;mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mm&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
	<span class="n">byip</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">bymask</span>
	<span class="k">if</span> <span class="n">byip</span><span class="p">:</span>
		<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;mm&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">df</span>

<span class="c1"># converts octets list to dictionary</span>
<span class="k">def</span> <span class="nf">_convert_list_to_dict</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
	<span class="n">dic</span><span class="p">,</span><span class="n">mm</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[],</span> <span class="mi">2</span><span class="p">:[],</span> <span class="mi">3</span><span class="p">:[]},[]</span>
	<span class="k">for</span> <span class="n">oNm</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">oNm</span><span class="p">:</span> <span class="k">continue</span>
		<span class="n">mm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oNm</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">])</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
			<span class="n">dic</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oNm</span><span class="p">[</span><span class="s1">&#39;octets&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
	<span class="n">dic</span><span class="p">[</span><span class="s1">&#39;mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mm</span>
	<span class="k">return</span> <span class="n">dic</span>

<span class="c1"># join list format octet back to string in dataframe</span>
<span class="k">def</span> <span class="nf">_join_octets_fr_df</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
		<span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
	<span class="k">return</span> <span class="p">[</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;mm&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span> <span class="p">]</span>


<div class="viewcode-block" id="sorted_v4_addresses">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.sorted_v4_addresses">[docs]</a>
<span class="k">def</span> <span class="nf">sorted_v4_addresses</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;sort IPv4 addresses (subnets)</span>

<span class="sd">	Args:</span>
<span class="sd">		args (list): list of addresses/subnets</span>
<span class="sd">		ascending (bool or list of bool, optional): Sort ascending vs. descending. Specify list for multiple sort orders. If this is a list of bools, must match the length of the by. Defaults to True.</span>

<span class="sd">	Returns:</span>
<span class="sd">		list: sorted list</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">return</span> <span class="n">_join_octets_fr_df</span><span class="p">(</span>
		<span class="n">_get_sorted_dataframe</span><span class="p">(</span>
			<span class="n">_convert_list_to_dict</span><span class="p">([</span> <span class="n">ipv4_octets</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">]),</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span> <span class="p">)</span>
		<span class="p">)</span></div>



<div class="viewcode-block" id="sort_by_size">
<a class="viewcode-back" href="../../../docs/t_doc/addressing/addressing.html#nettoolkit.addressing.addressing.sort_by_size">[docs]</a>
<span class="k">def</span> <span class="nf">sort_by_size</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;sort IPv4 addresses (sort by mask)</span>

<span class="sd">	Args:</span>
<span class="sd">		args (list): list of addresses/subnets</span>

<span class="sd">	Returns:</span>
<span class="sd">		list: sorted list</span>
<span class="sd">	&quot;&quot;&quot;</span>	
	<span class="k">return</span> <span class="n">_join_octets_fr_df</span><span class="p">(</span>
		<span class="n">_get_sorted_dataframe</span><span class="p">(</span>
			<span class="n">_convert_list_to_dict</span><span class="p">([</span> <span class="n">ipv4_octets</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">]),</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bymask</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
		<span class="p">)</span></div>


<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="c1"># Main Function</span>
<span class="c1"># ----------------------------------------------------------------------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="k">pass</span>
<span class="c1"># END</span>
<span class="c1"># ----------------------------------------------------------------------------</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ALIASGAR [ALI].</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>